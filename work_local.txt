. /net/is-nfsorad/cfs/is-nfsorad/ora_export/g46480/oracleprofile
. /net/is-nfsorad/cfs/is-nfsorad/ora_export/g46480/bin/setprofile
alter flashback archive AUDIT_ARCHIVE1 modify tablespace NORDEA_AUDIT_FDA quota 4 t;
exec dbadmin.SPACECHECK.ADD_FILES('NORDEA_AUDIT_HIST',2)
exec dbadmin.SPACECHECK.ADD_FILES('CCRD_BI_T',1)
$ENV:PATH=$ENV:PATH+";h:\bin"  

welcome1 
db-e901oe03d.qaoneadr.local
db-e901hh01d.qaoneadr.local

Dbfs2018

~oracle/dbadmin/alert_monitor/monitor.sh maintenance on ${ORACLE_SID} 
~oracle/dbadmin/alert_monitor/monitor.sh maintenance off ${ORACLE_SID} 
~oracle/dbadmin/alert_monitor/monitor.sh stop 

for ip in $(ifconfig -a|grep "inet " |awk '{print $2}') ; do nslookup $ip ; done|grep "name ="
for ip in $(ifconfig -a|grep inet|awk '{print substr($2,6)}') ; do nslookup $ip ; done|grep "name ="
for db in $(ps -u oracle -o cmd|grep smon|awk '{print substr($1,10,length($1)-10)}') ; do . s $db; chkmrp ; done
u=$(ls -ld /dev/sd*1|wc -l);a=$(ls -ld /dev/sd*|grep -v "[0-9]$"|wc -l);echo "Available devs=$a Used=$u unallocated=$(( $a - $u ))"



select round(sum(decode(name,'session uga memory',value,0))/1024/1024/1024) uga,round(sum(decode(name,'session uga memory max',value,0))/1024/1024/1024) ugamax
,round(sum(decode(name,'session pga memory',value,0))/1024/1024/1024) pga,round(sum(decode(name,'session pga memory max',value,0))/1024/1024/1024) pgamax
from gv$sysstat
/

conn sys/Pony2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mccp-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mccp-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=mccp)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC)))) 

conn system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=ora_twp_ro.oneadr.net)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=twp))) 

conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mimp-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mimp-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=mimp)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC)))) 

conn system/Deep2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-gsctsd-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-gsctsd-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=gsctsd)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC)))) 



conn system/Deep2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-ndfd-a.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-ndfd-b.qaoneadr.local)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=ndfd)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))

conn system/d6Triton@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-apsoad-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-apsoad-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=apsoad)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
conn DBFSTCCM/Dbfs2018@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=db-s010hhp-scan.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=db-s010oep-scan.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=fs010p)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC)))) 

conn sys/d3triton@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=db-twd-oe1.oneadr.net)(PORT=1521))(CONNECT_DATA=(sid=tw3d))) as sysdba 
conn /@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=db-twd-oe1.oneadr.net)(PORT=1521))(CONNECT_DATA=(sid=tw3d)))

conn sys/Tend2last4ever@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=db-s003hh04d-vip.qaoneadr.local)(PORT=1521))(CONNECT_DATA=(sid=s0091t1h4))) as sysdba 

g49166@g49166-udm#QAONEADR.LOCAL@db-e901hh01d.qaoneadr.local@psmp.prod.oneadr.net

ls -l /u040/oradata/twp/group3/datafile/tgl_pt2_256m_592.dbf /u080/oradata/twp/group2/datafile/collat_t_8m_769.dbf
ls -l /u040/oradata/twht/group3/datafile/tgl_pt2_256m_592.dbf /u080/oradata/twht/group2/datafile/collat_t_8m_769.dbf

g46480@g46480-udm#qaoneadr.local@db-info3d-hh2@ap-cybark6p.oneadr.net




cat /net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/Linux_64/CloneTree/12.1.0.2/install_sets/install_binaries/cmio_oracle_12102_ver200114a.tar.gz|gunzip
cat /net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/Linux_64/CloneTree/12.1.0.2/install_sets/install_binaries/cmio_oracle_cw_12102_ver200114a.tar.gz

mkdir -p ~/g46480/nimded1h1_20200826
g46480@g46480-udm#qaoneadr.local@db-marius1s@ap-cybark6p.oneadr.net
g46480@g46480-udm#qaoneadr.local@db-remed-oe2@ap-cybark6p.oneadr.net

g46480@G46480-udm#oneadr.net@is-vnc2p@ap-cybark2p.oneadr.net
g46480@g46480-udm#qaoneadr.local@is-exaschd@psmp.prod.oneadr.net 
g46480@G46480-udm#oneadr.net@is-exasch1p@psmp.prod.oneadr.net 70224747
g46480@G46480-udm#oneadr.net@is-vnc2p@psmp.prod.oneadr.net 70224747
g46480@G46480-udm#oneadr.net@db-csgpp-dga.oneadr.net@psmp.prod.oneadr.net 
g46480@G46480-udm#oneadr.net@dkd1mr7913@psmp.prod.oneadr.net 
g46480@G46480-udm#oneadr.net@db-mccvd-a@psmp.prod.oneadr.net 
g46480@G46480-udm#oneadr.net@ora_twp@psmp.prod.oneadr.net 
g46480@G46480-udm#oneadr.net@db-wstcp-a@psmp.prod.oneadr.net 
g46480@g46480-udm#qaoneadr.local@ap-cocot2d@psmp.prod.oneadr.net 
g46480@G46480-udm#oneadr.net@ap-dsetdw2p@psmp.prod.oneadr.net 
Justyna Kowalczewska
Matias Placido

jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-brcdt-a.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-brcdt-b.qaoneadr.local)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=brcdt_ro)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC)))) 

@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-brcdt-a.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-brcdt-b.qaoneadr.local)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=brcdt_ro)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC)))) 

jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-csgpp-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-csgpp-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=csgpp_ro)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC)))) 

jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-csgpd-a.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-csgpd-b.qaoneadr.local)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=csgpd)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC)))) 

ora-osbacc02p-b.oneadr.net
jdbc:oracle:thin:@//is-exasch1d.qaoneadr.local:1521/CCDEMSOAP 
njmftd
conn system/Deep2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-ccdemd-a.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-ccdemd-b.qaoneadr.local)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=WFOT)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
conn system/Town2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-wft-a.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-wft-b.qaoneadr.local)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=wft)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))

system/Town2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-brcdt-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-brcdt-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=brcdt_ro)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))

conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-csgpp-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-csgpp-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=csgpp)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-unikap-ro.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=unikap-ro)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))


dbpump forsvinder


conn system/d6triton@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-njmftd-a)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-njmftd-b)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=njmftd)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))


ALTER SESSION SET EVENTS '<error code> trace name errorstack level 3';
ALTER SYSTEM SET EVENTS '<error code> trace name errorstack off';

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/Linux_64/CloneTree/11.2.0.4/bin/autospace_inst.sh nimit
/net/js/Nordea/scripts/postz -h $(hostname) -i 10000:0:0:00
/net/js/Nordea/scripts/postz -h $(hostname) -i 0:0:0:10
export PATH=$PATH:/net/dkd1mr7913/export/install/media/oracle/sun/opatch/OPatch_11.2.0.3.14 
export PATH=$PATH:/net/dkd1mr7913/export/install/media/oracle/sun/opatch/OPatch_11.2.0.3.6 

$ORACLE_HOME/OPatch/opatch lsinventory -jre $ORACLE_HOME/jdk -invPtrLoc ${ORACLE_HOME}/oraInst.loc
opatch lsinventory -invPtrLoc ${ORACLE_HOME}/oraInst.loc
opatch lsinventory -invPtrLoc ${ORACLE_HOME}/oraInst.loc >>${ORACLE_SID}_$(date +%Y%m%d%H%M%S)_opatch.log
opatch prereq CheckConflictAgainstOHWithDetail -invPtrLoc ${ORACLE_HOME}/oraInst.loc -phBaseDir ./

select name, inst_id,name, from v$pdbs where opengv$pdbs where open_mode='open m_mode not in ('MOUNTED');

$ORACLE_HOME/OPatch/opatch prereq CheckConflictAgainstOHWithDetail -ph ./ -invPtrLoc ${ORACLE_HOME}/oraInst.loc
opatch apply  -invPtrLoc ${ORACLE_HOME}/oraInst.loc
Z:\Oracle Team room\Database Parameters\Oracle Parameters when moving from Capped CPU to Fair Share on Solaris.docx

export JAVA_HOME=/u01/app/oracle/product/11.2.0.4/grid_1/jdk
/net/dkd1mr7913/export/install/media/oracle/sun/opatch/OPatch_11.2.0.3.6/ocm/bin/emocmrsp


opatch prereq CheckConflictAgainstOHWithDetail -ph ./ -invPtrLoc ${ORACLE_HOME}/oraInst.loc

opatch apply -invPtrLoc ${ORACLE_HOME}/oraInst.loc

ps -ef|egrep "smon|tns|monitor_alert_itm|emagent"
Thorbjorn.Schibelfeldt@nordea.com
. ~g46480/e
~/dbadmin/alert_monitor/clear_event.sh


ilom 1 node i clusteret. 

nohup ~/dbadmin/spacecheck/autospace_${ORACLE_SID}.sh &
-- db-create 
-- 1. Install client software
su - oracle
/net/is-nfsorad/cfs/is-nfsorad/ora_export/sun/server_install/initial_setup.sh
sudo /net/is-nfsorad/cfs/is-nfsorad/ora_export/sun/server_install/initial_setup_root.sh
sudo /net/dkd1mr7913/export/install/media/oracle/sun/server_install/initial_setup_root.sh
sudo /u01/app/oracle/product/agent11g/root.sh
-- 2. Install database software
export ORACLE_HOME=/u01/app/oracle/product/11.2.0.4/db201020a
export ORACLE_BASE=/u01/app/oracle
nohup /net/dkd1mr7913/export/install/media/oracle/sun/clone_tree/11.2.0.4/install_11.2.0.4.sh &

18377986|19372024|20634449|21826068|22629760|25296876|19449552|23514710
CYBERARK-50OI

export ORACLE_HOME=/u01/app/oracle/product/11.2.0.4/dbhome_1
export ORACLE_BASE=/u01/app/oracle
cat <<__eof__ >$ORACLE_HOME/oraInst.loc
inventory_loc=$ORACLE_HOME/oraInventory
inst_group=oinstall
__eof__
rm -r $ORACLE_HOME/oraInventory
cd $ORACLE_HOME/clone/bin
perl clone.pl ORACLE_HOME=$ORACLE_HOME ORACLE_BASE=$ORACLE_BASE OSDBA_GROUP=oinstall OSOPER_GROUP=oinstall -invPtrLoc $ORACLE_HOME/oraInst.loc

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/sparc/CloneTree/12.1.0.2/install_12.1.0.2.sh

export ORACLE_HOME=/u01/app/oracle/product/12.1.0.2/dbhome_1
export ORACLE_BASE=/u01/app/oracle
/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/sparc/CloneTree/12.1.0.2/install_12.1.0.2.sh


tail -100f nohup.out
sudo  /net/dkd1mr7913/export/install/media/oracle/sun/clone_tree/11.2.0.4/root.sh
sudo /u01/app/oracle/product/11.2.0.4/dbhome_1/root.sh


-- 3. Create database 
# nohup /net/is-nfsorad/cfs/is-nfsorad/ora_export/sun/clone_tree/11.2.0.4/scripts/CreateDB/db.sh <SID> &
nohup /net/is-nfsorad/cfs/is-nfsorad/ora_export/sun/clone_tree/11.2.0.4/scripts/CreateDB/db.sh <SID> &
DBMS_AUDIT_MGMT.SET_AUDIT_TRAIL_LOCATION
@?/rdbms/admin/awrddrpt # awrdiff


export ORACLE_HOME=/u01/app/oracle/product/12.1.0.2/dbhome_1
export ORACLE_BASE=/u01/app/oracle
nohup /net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/sparc/CloneTree/12.1.0.2/install_12.1.0.2.sh &

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/sparc/CloneTree/12.1.0.2/CreateDb/db.sh orcl1t 

clonedbdir=/net/is-nfsorad/cfs/is-nfsorad/ora_export/sun/clone_tree/11.2.0.4/scripts/CreateDB
scriptdir=/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts




if [ -e ~/motd ] ; then cat ~/motd;stat motd|awk '{if($1=="Modify:")print "Motd last modified " $2 " " substr($3,1,8);}'; fi
# set up user directories
user=$(who am i|awk '{print $1}')
eval userhome=~$user
if [[ -x "$userhome/oracleprofile" ]] ; then
. $userhome/oracleprofile
else
  if [[ -x "/net/is-nfsorad/cfs/is-nfsorad/ora_export/${user}/oracleprofile" ]] ; then
    . /net/is-nfsorad/cfs/is-nfsorad/ora_export/${user}/oracleprofile
  fi
fi

ALTER TABLESPACE "MA_DIRECTOR_T" RESIZE      16385 G;

dgmgrl
connect sys/" . $DbPass . "@" . $PrimarySid
disable configuration"
remove configuration"
CREATE CONFIGURATION db_" . $DbName . " AS PRIMARY DATABASE IS " . $PrimarySid
" CONNECT IDENTIFIER IS '" . $PrimarySid . "';"
add database " . $Sid . " as CONNECT IDENTIFIER IS '" . $Sid . "';"
EDIT DATABASE '"  . $PrimarySid . "' SET PROPERTY StaticConnectIdentifier='" . $PrimarySid . "';"
EDIT DATABASE '"  . $Sid . "' SET PROPERTY StaticConnectIdentifier='" . $Sid . "';"
EDIT DATABASE '"  . $PrimarySid . "' SET PROPERTY ApplyParallel=12;"
EDIT DATABASE '"  . $Sid . "' SET PROPERTY ApplyParallel=12;"
enable configuration;"
quit"


v$datafile_header
select hxfil FileNo, HXONS OnlineStatus, FHSTA status, FHSCN SCN, FHTHR Thread,FHRBA_SEQ Sequence, FHTNM TABLESPACE_NAME 
from x$kcvfhall
where FHSTA<>0;

cd $ORACLE_HOME/rdbms/lib
make -f $ORACLE_HOME/rdbms/lib/ins_rdbms.mk dnfs_on


md5sum $ORACLE_HOME/lib/libnfsodm1[12].so $ORACLE_HOME/lib/libodm1[12].so $ORACLE_HOME/rdbms/lib/odm/libnfsodm1[12].so
af868ebabfb84aee73f17a865637a2d6  /u01/app/oracle/product/current/tcdbp_home/lib/libnfsodm11.so
af868ebabfb84aee73f17a865637a2d6  /u01/app/oracle/product/current/tcdbp_home/lib/libodm11.so

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/backup/prep_disk

df -h /zfssa/ess*/rmanprod/rman*|sort

exec dbadmin.spacecheck.add_files('IBRAIN_T_256M',8)

DECLARE
 job1 NUMBER;
BEGIN
 job1 := DBMS_DATAPUMP.ATTACH('SYS_IMPORT_SCHEMA_01','SYSTEM');
 DBMS_DATAPUMP.STOP_JOB (job1);
END;
/
~oracle/dbadmin/backup/db_backup.sh ORACLE_SERVICE=orclt BACKUP_ARCHIVE_ONLY=YES &

Bug 13872512

nohup ~/dbadmin/backup/db_backup.sh ORACLE_service=info3d LEVEL0=YES CHANNELS=1 BACKUP_DB_ONLY=YES CHANNELS=1 &
nohup ~/dbadmin/backup/db_backup.sh ORACLE_service=smgrp BACKUP_ARCHIVE_ONLY=YES CHANNELS=1 &
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SERVICE=tipp BACKUP_ARCHIVE_ONLY=YES &  

nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SERVICE=uc4t BACKUP_ARCHIVE_ONLY=YES &  

#linux 
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SERVICE=info3d BACKUP_ARCHIVE_ONLY=YES &  
nohup ./db_backup.sh ORACLE_SERVICE=tfbot LEVEL0=YES BACKUP_DB_ONLY=YES &  
nohup ~oracle/dbadmin/backup/db_backup.sh CAT_USER=NDE BACKUP_ARCHIVE_ONLY=YES  &


#Solaris
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SERVICE=uc4d BACKUP_ARCHIVE_ONLY=YES &  

nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SERVICE=remed BACKUP_ARCHIVE_ONLY=YES &
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SERVICE=uc4d BACKUP_ARCHIVE_ONLY=YES &
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SERVICE=remed LEVEL0=YES CHANNELS=1 BACKUP_DB_ONLY=YES &
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SERVICE=uc4d LEVEL0=YES CHANNELS=1 BACKUP_DB_ONLY=YES &


nohup ~oracle/dbadmin/backup/db_backup_ha.sh CAT_USER=imst LEVEL0=YES CHANNELS=1 BACKUP_DB_ONLY=YES &
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SID=info2p BACKUP_ARCHIVE_ONLY=YES CAT_USER=infop &
nohup ~/dbadmin/backup/db_backup.sh ORACLE_SID=imt CAT_USER=imt BACKUP_ARCHIVE_ONLY=YES CHANNELS=1 &
nohup ~/dbadmin/backup/db_backup.sh ORACLE_SID=reut2p BACKUP_ARCHIVE_ONLY=YES CHANNELS=1 CAT_USER=reutp &
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SID=calyprf1 LEVEL0=YES CHANNELS=1 CAT_USER=calyprf1 BACKUP_DB_ONLY=YES &
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SID=tipt8 LEVEL0=YES CHANNELS=1 CAT_USER=tipt8 BACKUP_DB_ONLY=YES &
nohup ~/dbadmin/backup/db_backup.sh ORACLE_SID=tpremiaa BACKUP_ARCHIVE_ONLY=YES CHANNELS=1 CAT_USER=tpremiaa &
nohup ~oracle/dbadmin/backup/backup.sh ORACLE_SID=damd1t BACKUP_ARCHIVE_ONLY=YES  &
nohup ~oracle/dbadmin/backup/db_backup.sh ORACLE_SID=tipt9 BACKUP_ARCHIVE_ONLY=YES CAT_USER=tipt9 &

Exadata
nohup ./db_backup.sh  ENV_FILE=/me01/oracle/dbadmin/backup/exa_hh_test.cfg TARGET_DATABASE=cbpd CAT_USER=cbpd BACKUP_ARCHIVE_ONLY=YES ARCH_CHANNELS=4 &
nohup ./db_backup.sh  ENV_FILE=/me01/oracle/dbadmin/backup/exa_cb_test.cfg TARGET_DATABASE=nims2t CAT_USER=nims2t BACKUP_ARCHIVE_ONLY=YES ARCH_CHANNELS=16 &

exec dbadmin.spacecheck.add_files('CALYPSO_T_256M',2) 
exec dbadmin.spacecheck.add_files('NORDEA_AUDIT_HIST',2) 

/net/dkd1mr7913/export/install/media/oracle/scripts/goldengate/ogg_install112.sh bire1t 11
 

/net/dkd1mr7913/export/install/media/oracle/scripts/blackout/install_blackout_scripts.sh
~/dbadmin/blackout/blackout_all_start.sh

	set pages 9999 lines 140 trims on long 999999 serveroutput on size 999999 
	col name form a60
	select type,substr(name,1,instr(name,'/',1)-1) name,round(sum(bytes)/1024/1024) mb,count(*) cnt  from
	(select 'data' type,name,bytes from v$datafile union all select 'temp',name,bytes from v$tempfile 
	union all select 'ctl',name,BLOCK_SIZE*FILE_SIZE_BLKS  from v$controlfile union select 'redo',member,l.bytes from v$logfile f,v$log l where f.group#=l.group#)
	group by type,substr(name,1,instr(name,'/',1)-1) order by substr(name,1,instr(name,'/',1)-1),type;

(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-gped-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-gped-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=gped)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))


set pages 9999 lines 140 trims on long 999999 serveroutput on size 999999 
col name form a60
select type,substr(name,1,instr(name,'/',-1)-1) name,round(sum(bytes)/1024/1024) mb,count(*) cnt  from
(select 'data' type,name,bytes from v$datafile union all select 'temp',name,bytes from v$tempfile 
union all select 'ctl',name,BLOCK_SIZE*FILE_SIZE_BLKS  from v$controlfile union select 'redo',member,l.bytes from v$logfile f,v$log l where f.group#=l.group#)
group by type,substr(name,1,instr(name,'/',-1)-1) order by substr(name,1,instr(name,'/',-1)-1),type;

select name,sum(mb) mb,sum(cnt) cnt from ( 
select type,substr(name,1,instr(name,'/',1)-1) name,round(sum(bytes)/1024/1024) mb,count(*) cnt  from
(select 'data' type,name,bytes from v$datafile union all select 'temp',name,bytes from v$tempfile 
union all select 'ctl',name,BLOCK_SIZE*FILE_SIZE_BLKS  from v$controlfile union select 'redo',member,l.bytes from v$logfile f,v$log l where f.group#=l.group#)
group by substr(name,1,instr(name,'/',1)-1),type 
order by substr(name,1,instr(name,'/',1)-1),type)
group by name;

select name,sum(mb) mb,sum(cnt) cnt from ( 
select type,substr(name,instr(name,'/',-1)+1) name,round(sum(bytes)/1024/1024) mb,count(*) cnt  from
(select 'data' type,name,bytes from v$datafile union all select 'temp',name,bytes from v$tempfile 
union all select 'ctl',name,BLOCK_SIZE*FILE_SIZE_BLKS  from v$controlfile union select 'redo',member,l.bytes from v$logfile f,v$log l where f.group#=l.group#)
group by substr(name,instr(name,'/',-1)+1),type 
order by substr(name,instr(name,'/',-1)+1),type)
group by name
having count(*)>1;


col name form a60
select substr(name,1,instr(name,'/',-1)-1) name,round(sum(bytes)/1024/1024) mb from
(select name,bytes from v$datafile union all select name,bytes from v$tempfile 
union all select name,0  from v$controlfile union select member,0 bytes from v$logfile)
group by substr(name,1,instr(name,'/',-1)-1)
order by substr(name,1,instr(name,'/',-1)-1);


select tracefile from v$process where addr=(select paddr from v$session where sid=(select sid from v$mystat where rownum<2));





x86 status 
Patch  13922299     : applied on Thu Jun 21 11:19:41 CEST 2012 mangler SR er lavet 
Patch  12920172     : applied on Mon May 14 13:35:18 CEST 2012 mangler 

col name form a60
select distinct substr(name,1,instr(name,'/',-1)-1) name from
(select name from v$datafile union all select name from v$tempfile 
union all select name from v$controlfile union select member bytes from v$logfile);
group by substr(name,1,instr(name,'/',-1)-1);


/net/dkd1mr7913/export/install/media/oracle/scripts/g99854/replay_script.sh
/net/dkd1mr7913/export/install/media/oracle/scripts/audit/auditenable.ksh
sqlplus dbsnmp/christian4tal @/net/dkd1mr7913/export/install/media/oracle/scripts/activate_options/compress_partitioning2.sql

sed "s-\/u01\/app\/oracle\/product\/11\.2\.0\.2\/client_1\/oraInventory-${ORACLE_HOME}/oraInventory-g" 

adrci q
show homes 
set home 
show incident -mode brief  -p "incident_id=95360689"
ips create package incident 95360689
IPS GENERATE PACKAGE 2 in /me01/oracle/g46480

ryd op
find . -mtime +8 -exec rm {} \;

ls -ld /me01/oracle/awf /me01p/gsi/Full /me01p/gsi/ftp_out /net/10.152.24.242/cfs/is-nfsorad/ora_export/export/gsip /u01/app/oracle/product/10.2.0/db_1/work /me01p/gsi/Parsed /u01/app/oracle/product/10.2.0/db_1/ccr/state /u01/app/oracle/admin/gsip/dpdump/ /me01p/gsi/ftp_in 

reclaimable

/net/is-nfsorad/cfs/is-nfsorad/ora_export

SQL> select 'alter user "'||name||'" identified by value '''||password||''';' from user$ where name='OLCORE';
alter user "OLCORE" identified by value '93341FC89418D819';
SQL> alter user olcore identified by oksasaks3t;

z:\Oracle Team room\Installation Guides\Oracle Grid Control Installation\Oracle installation Grid Agent 11g v1.2.doc
cd /net/dkd1mr7913/export/install/media/oracle/solaris_x86/11.2.0.3/grid


spool /u01/app/oracle/admin/@/pfile/upgrade_pre_@_11.2.0.3.log
create pfile='/u01/app/oracle/admin/@/pfile/init@_pre11.2.0.3.ora' from spfile;
@/u01/app/oracle/product/11.2.0.3/dbhome_1/rdbms/admin/utlu112i.sql
PURGE DBA_RECYCLEBIN;
EXECUTE dbms_stats.gather_dictionary_stats;
@?/rdbms/admin/utlrp





    Process Group: DEFAULT, pseudo proc: 0x5b89c1ef0
    O/S info: user: oracle, term: UNKNOWN, ospid: 10956
    OSD pid info: Unix process pid: 10956, image: oracle@db-calypp-a
 
exec dbms_workload_repository.modify_snapshot_settings(60*24*180,10)
select * from DBA_HIST_WR_CONTROl;

select begin_interval_time ,fetches_delta, executions_delta,  
  disk_reads_delta, buffer_gets_delta, elapsed_time_delta, cpu_time_delta, physical_read_bytes_delta,
  round(disk_reads_delta/executions_delta) disk_read, round(buffer_gets_delta/executions_delta) buffer_gets, 
  round(elapsed_time_delta/executions_delta) elapsed_time, 
  round(cpu_time_delta/executions_delta) cpu_time, round(physical_read_bytes_delta/executions_delta) physical_read_bytes
from dba_hist_sqlstat q, DBA_HIST_snapshot s
where q.snap_id = s.snap_id and q.instance_number = s.instance_number
and q.sql_id = '84g4j7buspwpz'
and begin_interval_time > to_date('2019-09-25 04', 'YYYY-MM-DD HH24')
order by begin_interval_time, plan_hash_value;


exec dbms_workload_repository.create_snapshot()
set termout on  pages 0 heading off linesize 9999 echo off feedback off trims on 
col output form a9999


spool nimtrt1_awr_2016-11-23-1019.html 
select output from table(dbms_workload_repository.awr_report_html(1424841939,1,4352,4356,8));
spool off 
spool nimtrt2_awr_2016-11-23-1019.html 
select output from table(dbms_workload_repository.awr_report_html(1424841939,2,4352,4356,8));
spool off 
spool nimtrt_awr_2016-11-23-1019.html 
select output from table(dbms_workload_repository.awr_global_report_html(1424841939,'1,2',4352,4356,8));
spool off 
4764,

spool infop_awr_2013-12-02-0459.html 
select output from table(dbms_workload_repository.awr_report_html(988383086,1,4759,4763,8));
spool infop_awr_2013-12-02-0559.html 
select output from table(dbms_workload_repository.awr_report_html(3359868069,1,179627,179628,8));
spool infop_awr_2013-12-03-0309.html 
select output from table(dbms_workload_repository.awr_report_html(3359868069,1,179754,179755,8));
spool infop_awr_2013-12-03-0349.html 
select output from table(dbms_workload_repository.awr_report_html(3359868069,1,179758,179759,8));
spool infop_awr_2013-12-04-0419.html 
select output from table(dbms_workload_repository.awr_report_html(3359868069,1,179904,179905,8));
spool infop_awr_2013-12-04-0439.html 
select output from table(dbms_workload_repository.awr_report_html(3359868069,1,179906,179907,8));
spool off 

select output from table(DBMS_WORKLOAD_REPOSITORY.AWR_SQL_REPORT_HTML(2404505770,1,1233,1234,'1tbkyhp6curdt'));
cmwgxv2armvr7
fbmjfhw4ust7j
a3gyjbq65mwuq
b7vjpra8u3yxp
cdkjzj4r06byw


in upgrade mode 
spool /u01/app/oracle/admin/@/pfile/upgrade_@_11.2.0.3.log
create spfile from pfile='/u01/app/oracle/admin/@/pfile/init@_11g.ora';
STARTUP UPGRADE
@catupgrd.sql
STARTUP UPGRADE
exec	dbms_dst.begin_upgrade(14);

after restart
set lines 140 pages 9999 serveroutput on size 999999 
declare 
	l_errors binary_integer;
begin 
	dbms_dst.upgrade_database(l_errors);
	dbms_output.put_line('upgrade_database return error='||l_errors);
	dbms_dst.end_upgrade(l_errors);
	dbms_output.put_line('end_database return error='||l_errors);
end;

declare
l_latency number; 
l_iops number;
l_mbps number;
begin
dbms_resource_manager.calibrate_io(num_physical_disks=>6,max_latency=>12,max_iops=>l_iops,max_mbps=>l_mbps,actual_latency=>l_latency);
dbms_output.put_line('max_iops='||l_iops||'   max_mbps='||l_mbps||'  actual_latency='||l_latency);
end;
/
exec dbms_stats.gather_dictionary_stats
exec dbms_stats.gather_fixed_objects_stats


. oraenv 
agent 
agentca -d





set pages 999 lines 140 trims on
select 'rm '||name from
(select name from v$datafile union all select name from v$tempfile 
union all select name from v$controlfile union all select member from v$logfile);


	
  num_of_failures    OUT  BINARY_INTEGER);

modinfo | grep ODM | grep VRTS
cat /dev/odm/stats
df | grep odm
ls -l $ORACLE_HOME/lib/libodm11.so

mv $ORACLE_HOME/lib/libodm11.so $ORACLE_HOME/lib/libodm11_orig.so
ln -s /opt/VRTSodm/lib/sparcv9/libodm.so $ORACLE_HOME/lib/libodm11.so


create user g46480 identified by ostepops default tablespace users temporary tablespace temp quota unlimited on users;
grant create session,alter session,create table,create view,create sequence,create trigger,create procedure to g46480;
alter user PERFSTAT grant connect through g46480;
conn g46480[perfstat]
exec dbms_job.remove(295469);



/u01/app/oracle/product/agent10g/sysman/admin/scripts/hostbufferactivity.pl 
/u01/app/oracle/product/agent10g/sysman/admin/scripts/hostsysswapswitch.pl

for f in `ls -1 *.ora` ; do mv $f $(echo $f|awk -F. '{print $1}').dbf;done

begin 
  for r1 in (select owner,object_name from dba_objects where object_type in ('VIEW TABLE') and owner in ('TWCALYP CALYPSO CALYPSO_MIDTIER')) loop 
    begin 
      execute immediate 'grant select on "'||r1.owner||'"."'||r1.object_name||'" to CALYPSO_ALL_READ';
    exception when others then 
      dbms_output.put_line(sqlerrm||' grant  select on "'||r1.owner||'"."'||r1.object_name||'" to CALYPSO_ALL_READ');
    end;
  end loop;
end;
/

/net/dkd1mr7913/export/install/media/oracle/scripts/g99854/check_replay.sh
/export/install/media/oracle/scripts/g99854
/net/js/export/public/g99854
/net/dkd1mr7913/export/install/media/oracle/scripts

/u01/app/grid/product/11.2.0.3/grid/crs/install/rootcrs.pl -deconfig -force





chomp ($os = `uname -s`);

vi /u01/app/oracle/product/agent11g/sysman/admin/scripts/hostsysswapswitch.pl /u01/app/oracle/product/agent11g/sysman/admin/scripts/hostbufferactivity.pl
if ( $os eq "SunOS" || $os eq "HP-UX" ) {
## Arne og Bo -- BEGIN
## slet fra og med 'Arne og Bo -- BEGIN' til og med 'Arne og Bo -- END' for at stille tilbage
  die "unsupported platform";
}
elsif ( "Ja" eq "Nej" ) {
## Arne og Bo -- END
# invoke sar
$r = `sar -b 5`
    or die "failed to execute sar";


	
	

/u01/app/grid/product/11.2.0.3/grid/bin/crsctl delete node -n dkd1mr7205
/u01/app/grid/product/11.2.0.3/grid/bin/crsctl stop crs 
/u01/app/grid/product/11.2.0.3/grid/bin/crsctl start crs
/u01/app/grid/product/11.2.0.3/grid/bin/crs_stat -t

 
cd /u01/app/oracle/admin/calypfxp/scripts
diff CreateDB.sql /net/dkd1mr7913/export/install/media/oracle/sun/clone_tree/11.2.0.3/scripts/CreateDB/CreateDB.sql

/net/dkd1mr7913/export/install/media/oracle/sun/clone_tree/11.2.0.3/scripts/CreateDB/calypfxp.sh
/net/dkd1mr7913/export/install/media/oracle/sun/clone_tree/11.2.0.3/scripts/CreateDB/calypfxp.sql


HOSTNAME=`hostname`
PORT=`echo $DISPLAY|awk -F: '{print $2}'|awk -F. '{print $1}'`
AUTH=`xauth list|grep ${HOSTNAME}/unix:$PORT`
echo "export DISPLAY=localhost:"${PORT}".0" >>/tmp/DISPLAY_$$.sh 
echo "xauth add "${AUTH} >>/tmp/DISPLAY_$$.sh 
chmod 755 /tmp/DISPLAY_$$.sh 



#!/bin/ksh
#!/usr/bin
#!/usr/bin/expect --
expect -f -<<EOF
spawn -noecho scp -p remote_server:file local_directory
expect "Password:"
send "$$$$$$$"
expect "\n"
EOF



create index CALYPSO_MIDTIER.ANALYSIS_MESSAGE_ix01 on CALYPSO_MIDTIER.ANALYSIS_MESSAGE(source_id,task_id) tablespace CALYPSO_I;

 	
select count(*),logtime from (
select case when (FIRST_TIME-last_first_time)*(24*60*60) < 5 then 5 
when (FIRST_TIME-last_first_time)*(24*60*60) between 6 and 10 then 10 
when (FIRST_TIME-last_first_time)*(24*60*60) between 11 and 60 then 60 
when (FIRST_TIME-last_first_time)*(24*60*60) between 61 and 300 then 300 
when (FIRST_TIME-last_first_time)*(24*60*60) between 301 and 1800 then 1800
else 3600 end logtime 
from (select FIRST_TIME,lag(first_time) over(order by THREAD#,SEQUENCE#) last_first_time from v$archived_log order by THREAD#,SEQUENCE#))
group by logtime 
order by logtime
/	


select 'alter user "'||username||'" profile TECHNICAL_USER_PROFILE;' from dba_users where username like 'MCC%' and profile='DEFAULT'

 declare 
  l_sec_case_sensitive_logon varchar2(5):='FALSE';
  procedure prn(p_msg in varchar2) as 
  begin 
    dbms_output.put_line(p_msg);
  end;
  procedure doit(p_sql in varchar2) as 
  begin 
	execute immediate p_sql;
  exception
    when others then 
	  prn(sqlerrm||' <'||p_sql||'>');
  end;
  procedure resetexpire(p_database in varchar2,p_name in varchar2) as 
    l_name varchar2(32);
  begin 
    select name into l_name from v$database;
	if p_database<>l_name then 
	  prn('Actual database <'||l_name||'> different from wantet database <'||p_database||'>');
      return;
    end if;
    select value into l_sec_case_sensitive_logon from v$parameter where name='sec_case_sensitive_logon';
    for r1 in (select name,decode(l_sec_case_sensitive_logon,'TRUE',spare4,password) password from user$ where name like '%'||p_name||'%' and astatus<>0) loop
--      doit('alter user "'||r1.name||'" identified by values '''||r1.password||'''');
      prn('alter user "'||r1.name||'" identified by values '''||r1.password||'''');
    end loop;
  end;
begin   
  resetexpire('MCCT MCC'); 
end;
/


alter system set log_archive_dest_1='LOCATION=USE_DB_RECOVERY_FILE_DEST VALID_FOR=(ALL_LOGFILES,ALL_ROLES) db_unique_name=cmccsmp_dg1' scope=both;
alter system set log_archive_dest_1='location=USE_DB_RECOVERY_FILE_DEST VALID_FOR=(ALL_LOGFILES,ALL_ROLES) db_unique_name=cmccsmp_dg2' scope=both;

set pages 9999 lines 140 trims on 
col status format a15
col mdat form a20
SELECT to_char(sysdate,'YYYY-MM-DD HH24:MI:SS') mdat, process, status, thread#, sequence#, block#, blocks
from v$managed_standby
where status not in ('CLOSING','IDLE')
and (thread#<>0 or sequence#<>0 or block#<>0)
order by process,sequence#
/
col datum_time form a20
col TIME_COMPUTED form a20
col value form a20
select name,value,unit,time_computed from v$dataguard_stats;

select min(sequence#),thread# from v$archived_log 
where (select distinct first_change# from v$archived_log where thread#=3 and sequence#=99225) 
between first_change# and next_change#
group by thread#
order by thread#;

declare v0 varchar2(256):='ORACLE_HOME';v1 varchar2(256);begin dbms_system.get_env(v0,v1); dbms_output.put_line(v0||'='||v1); end;
/
declare v0 varchar2(256):='TNS_ADMIN';v1 varchar2(256);begin dbms_system.get_env(v0,v1); dbms_output.put_line(v0||'='||v1); end;
/


-- On original primary:
login as oracle unix user
sqlplus / as sysdba 
select database_role,switchover_status from v$database;
-- must return the following:
--	DATABASE_ROLE    SWITCHOVER_STATUS
--	---------------- --------------------
--	PRIMARY          TO STANDBY

ALTER DATABASE COMMIT TO SWITCHOVER TO PHYSICAL STANDBY WITH SESSION SHUTDOWN;
shutdown immediate 
disconnect 
conn / as sysdba 
STARTUP MOUNT;
-- do not disconnect this session, this session will be resumed when activities on original standby are done 



-- when the orginal primary database has been shut down and started in mount mode then 

-- On original standby:
login as oracle unix user
sqlplus / as sysdba 
select database_role,switchover_status from v$database;
-- must return the following:
--	DATABASE_ROLE    SWITCHOVER_STATUS
--	---------------- --------------------
--	STANDBY          TO PRIMARY
-- It can take some time for the SWITCHOVER_STATUS to go from 'NOT ALLOWED' to 'TO PRIMARY', several minutes

ALTER DATABASE COMMIT TO SWITCHOVER TO PRIMARY WITH SESSION SHUTDOWN;
alter database open;
-- here the virtual ip address ora_remedyp are shutdown on the original primary and started on the original standby
-- and the virtual ip address ora_remedyp_ro are shutdown on the original standby and started on the original primary

-- On original primary: (session resume)
@~/dbadmin/standby/managed_recovery

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/utils/switchover/database_switchover.pl --db clsp --syspwd Pony2last4ever --switchover 

/opt/nordea/dataguard/dataguard_netconf 



mxdp1c
mxcp1c

conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mxdp-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mxdp-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=mxdp)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
select d.open_mode,d.database_role,i.instance_name,i.host_name from v$instance i,v$database d;

conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mxdp-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mxdp-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=mxdp_ro)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
select d.open_mode,d.database_role,i.instance_name,i.host_name from v$instance i,v$database d;


conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mxcp-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mxcp-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=mxcp)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
select d.open_mode,d.database_role,i.instance_name,i.host_name from v$instance i,v$database d;

conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mxcp-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-mxcp-b.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=mxcp_ro)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
select d.open_mode,d.database_role,i.instance_name,i.host_name from v$instance i,v$database d;


Rebuild standby on sop
https://nordea.sharepoint.com/sites/oracle-database/SME/Standard%20Operating%20Procedures%20Database/Forms/Category.aspx?q=rebuild&id=%2Fsites%2Foracle%2Ddatabase%2FSME%2FStandard%20Operating%20Procedures%20Database%2FRebuild%20standby%20database%20on%20SOP%2Etxt&parent=%2Fsites%2Foracle%2Ddatabase%2FSME%2FStandard%20Operating%20Procedures%20Database&parentview=7 

/opt/nordea/dataguard/dataguard_netconf -d pr
/opt/nordea/dataguard/dataguard_netconf -d ro 

/opt/nordea/dataguard/dataguard_netconf -p
/opt/nordea/dataguard/dataguard_netconf -r
dbadmin/alert_monitor/monitor.sh maintenance off ${ORACLE_SID}

conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-clsp.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=clsp)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
select d.open_mode,d.database_role,i.instance_name,i.host_name from v$instance i,v$database d;
conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-clsp-ro.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=clsp_ro)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))

conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-dshwp.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=dshwp)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
select d.open_mode,d.database_role,i.instance_name,i.host_name from v$instance i,v$database d;
conn system/Pack2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ora-dshwp-ro.oneadr.net)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=dshwp_ro)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))




ALTER DATABASE ADD STANDBY LOGFILE group 5 ('+reco','+data') SIZE 536870912;
ALTER DATABASE ADD STANDBY LOGFILE group 6 ('+reco','+data') SIZE 536870912;
ALTER DATABASE ADD STANDBY LOGFILE group 7 ('+reco','+data') SIZE 536870912;
ALTER DATABASE ADD STANDBY LOGFILE group 8 ('+reco','+data') SIZE 536870912;



ALTER DATABASE ADD STANDBY LOGFILE ('/u03/oradata/calypp/stbylog/stby2b.rdo /u02/oradata/calypp/stbylog/stby2a.rdo') SIZE 134217728;
ALTER DATABASE ADD STANDBY LOGFILE ('/u03/oradata/calypp/stbylog/stby3b.rdo /u02/oradata/calypp/stbylog/stby3a.rdo') SIZE 134217728;
ALTER DATABASE ADD STANDBY LOGFILE ('/u03/oradata/calypp/stbylog/stby4b.rdo /u02/oradata/calypp/stbylog/stby4a.rdo') SIZE 134217728;
ALTER DATABASE ADD STANDBY LOGFILE ('/u03/oradata/calypp/stbylog/stby5b.rdo /u02/oradata/calypp/stbylog/stby5a.rdo') SIZE 134217728;

#!/bin/bash
# set -x
client=`echo $SSH_CONNECTION|awk '{print $1}'`
if [[ $client != "" ]] ; then
  workstation=`nslookup $client|grep "name ="|awk '{print $4}'|awk -F. '{print $1}'`
fi
if [[ $SHELL != "/bin/bash" && $workstation == "dkcmwm15211538" ]] ; then
  export SHELL="/bin/bash"
  bash
  exit
fi

run {
allocate auxiliary channel aux1 device type sbt PARMS='ENV=(TDPO_OPTFILE=/opt/tivoli/tsm/client/oracle/bin64/tdpo_wsmcd.opt)';
set until time "to_date('20111205090000 yyyymmddhh24miss')";
DUPLICATE TARGET DATABASE TO wsmcore
db_file_name_convert('/wsmcd_data/ora_data /u02/oradata/wsmcore/datafile /wsmcd_data/ora_rbs /u02/oradata/wsmcore/datafile')
logfile group 1('/u03/oradata/wsmcore/onlinelog/redo_01b.log /u02/oradata/wsmcore/onlinelog/redo_01a.log') size 512m,
        group 2('/u03/oradata/wsmcore/onlinelog/redo_02b.log /u02/oradata/wsmcore/onlinelog/redo_02a.log') size 512m,
        group 3('/u03/oradata/wsmcore/onlinelog/redo_03b.log /u02/oradata/wsmcore/onlinelog/redo_03a.log') size 512m;
}


UFO_EFFEKT_IDENT,EFFECT_ID,ISIN,CUSIP,SEDOL,MIC,UPDATE_PGM_ID,UPDATE_DATETIME



subversion
Hej Poul (og Arne)

Der intet der tæller som rent held!

Jeg er jo ved at lave ny WIKI server til dokumentationen og har en dialog med Steen Ole Andersen og Stefan Skotte herom.
I samme moment er vi blevet enige om at ligge SubVersion på samme server.
Det bliver cmd1cs0032 (godt nok windows i VMWare farmen), men det betyder ikke så meget i den sammenhæng, andet end der så er taget hånd om ansvar, virus, patch osv. 

Serveren er klar med hensyn til wiki på mandag, men jeg ved endnu ikke hvornår den er klar med hensyn til SubVersion.
Måske Steen Ole har et bud herpå?

Mvh
Allan




ln -s /me01/oracle/ora_setup /var/opt/oracle
ln -s /me01/oracle/ora_setup/oraenv /usr/local/bin/oraenv
ln -s /me01/oracle/ora_setup/coraenv /usr/local/bin/coraenv
ln -s /me01/oracle/ora_setup/dbhome /usr/local/bin/dbhome


cd /net/dkd1mr7913/export/install/media/oracle/sun/oem/11.1.0.1.0_agent_full
cp  oraInst.loc_agent11g ~oracle/ora_setup/oraInst.loc_agent11g
unset ORACLE_BASE
unset ORACLE_HOME
unset ORACLE_SID
export ORACLE_HOSTNAME=ora_twmdatt
./solaris/agent/runInstaller -silent -invPtrLoc ~oracle/ora_setup/oraInst.loc_agent11g ORACLE_HOSTNAME=ora_twmdatt -responseFile /net/dkd1mr7913/export/install/media/oracle/sun/oem/11.1.0.1.0_agent_full/solaris/response/additional_agent.rsp -waitForComplet


for i in $(ifconfig -a|awk '{if($1=="inet") {print $2}}');do nslookup $i|awk '{if($2=="name")print $4}'|awk -F. '{print $1}';done|grep  '[\-a|\-b]$'

emctl stop agent
rm -r $AGENT_HOME/sysman/emd/state/* 
rm -r $AGENT_HOME/sysman/emd/collection/* 
find $AGENT_HOME/sysman/emd/upload/ -type f -name "*.xml" -exec rm {} \;
rm $AGENT_HOME/sysman/emd/lastupld.xml 
rm $AGENT_HOME/sysman/emd/agntstmp.txt 
rm $AGENT_HOME/sysman/emd/blackouts.xml
emctl clearstate agent
emctl secure agent
agent2reg
emctl start agent


unset ORACLE_BASE
unset ORACLE_HOME
unset ORACLE_SID
export ORACLE_HOSTNAME=ora_openlinkp_ro
./solaris/agent/runInstaller -silent -invPtrLoc ~oracle/ora_setup/oraInst.loc_agent11g ORACLE_HOSTNAME=${ORACLE_HOSTNAME} -responseFile /net/dkd1mr7913/export/install/media/oracle/sun/oem/11.1.0.1.0_agent_full/solaris/response/additional_agent.rsp


sqlplus / as sysdba 
col comp_name form a40
set pages 9999 lines 140 trims on
select comp_id,comp_name,status,version from dba_registry;
SELECT version from v$timezone_file;
quit;


tstmp=$(date +"%Y%m%d")
cp $ORACLE_HOME/sysman/admin/scripts/hostsysswapswitch.pl $ORACLE_HOME/sysman/admin/scripts/hostsysswapswitch_${tstmp}.pl
cp $ORACLE_HOME/sysman/admin/scripts/hostbufferactivity.pl $ORACLE_HOME/sysman/admin/scripts/hostbufferactivity_${tstmp}.pl
vi $ORACLE_HOME/sysman/admin/scripts/hostbufferactivity.pl $ORACLE_HOME/sysman/admin/scripts/hostsysswapswitch.pl
## Arne og Bo -- BEGIN
## slet fra og med 'Arne og Bo -- BEGIN' til og med 'Arne og Bo -- END' for at stille tilbage
  die "unsupported platform";
}
elsif ( "Ja" eq "Nej" )
{
## Arne og Bo -- END

select ah.ah_name, oh.oh_name,oh.oh_title,ah.ah_timestamp2,ah.ah_timestamp4,trunc((ah.ah_timestamp4-ah.ah_timestamp2)*24*60)||':'||trunc(mod(((ah.ah_timestamp4-ah.ah_timestamp2)*24*60*60),60)) elaps
,ah.*,oh.* 
from uc4admin.ah,uc4admin.oh 
where ah.ah_oh_idnr=oh.oh_idnr 
-- and ah_otype='JOBP'
and oh.oh_name in ('EOD_05_2_1DATA_TRADE EOD_05_2_2DATA_TRADE')
and ah.ah_timestamp1 between to_date('20121121000000 yyyymmddhh24miss') and to_date('20121204235959 yyyymmddhh24miss')
order by oh.oh_name,ah.ah_timestamp2;
  
  
select s.sid,l.KGLNAOBJ from X$KGLLK l,v$session s where l.KGLLKSES=s.saddr and s.event='library cache lock' and s.wait_time=0;
  
  
SELECT * FROM X$KGLLK LOCK_A 
WHERE KGLLKREQ = 0
   AND EXISTS (SELECT LOCK_B.KGLLKHDL FROM X$KGLLK LOCK_B
WHERE KGLLKSES in (select saddr from v$session where event='library cache lock' and wait_time=0)
AND LOCK_A.KGLLKHDL = LOCK_B.KGLLKHDL
AND KGLLKREQ > 0);  

select h.* from  X$KGLLK h
where KGLLKREQ = 0 
and h.KGLLKHDL in 
(select w.KGLLKHDL from X$KGLLK w
where w.KGLLKSES in (select saddr from v$session where event='library cache lock' and wait_time=0)
and w.KGLLKREQ > 0);  


systemstate 3

hanganalyse 5


select ah.ah_name, oh.oh_name,oh.oh_title,ah.ah_hostdst,ah.ah_timestamp2,ah.ah_timestamp4,trunc((ah.ah_timestamp4-ah.ah_timestamp2)*24*60)||':'||trunc(mod(((ah.ah_timestamp4-ah.ah_timestamp2)*24*60*60),60)) elaps
,ah.*,oh.* 
from uc4admin.ah,uc4admin.oh 
where ah.ah_oh_idnr=oh.oh_idnr 
-- and ah_otype='JOBP'
-- and (oh.oh_name in ('MX_EOD_05_2_1_DATA_TRADE MX_EOD_05_2_2_DATA_TRADE EOD_5_TRADEVAL_T VAR_DAYLAG1 VAR_DAYLAG2')
-- or oh.oh_name like 'VAR%')
and ah.ah_hostdst=upper('dkd1mr4008')
and ah.ah_timestamp1 between to_date('20120101000000 yyyymmddhh24miss') and to_date('20120124235959 yyyymmddhh24miss')
order by oh.oh_name,ah.ah_timestamp2;

select ah_name, ah_remotestatus from uc4admin.ah where ah.ah_timestamp4 is null or ah.ah_remotestatus<>0;



select eh.eh_name from uc4admin.eh,v$instance i where eh.eh_status<1700 and eh.eh_hostdst=upper(i.host_name);
  
 
col tablespace_name form a20
col allocate form 999g999g999
col used form 999g999g999
col maxsize form 999g999g999
col available form 999g999g999
col availpct form 99d99
set pages 9999 lines 140 trims on 
select tablespace_name,contents
,trunc(allocate/1024/1024) allocate,trunc(maxsize/1024/1024) maxsize,trunc(freesize/1024/1024) freesize
,trunc(used/1024/1024) used,trunc(available/1024/1024) available,to_char(available/maxsize*100,'999d99') avalipct
,case when available/maxsize>0.5 or available>(1024*1024*1024) then 'Ok' else 'Space should be added' end advice
from
(select f.tablespace_name,f.contents,f.Allocate,f.maxsize,sum(free.bytes) freesize,f.Allocate-sum(free.bytes) used,f.maxsize+sum(free.bytes)-f.allocate available  from dba_free_space free,
(select f.tablespace_name,t.contents,sum(f.bytes) Allocate,sum(decode(f.AUTOEXTENSIBLE,'YES',f.maxbytes,f.bytes)) maxsize
from dba_data_files f,dba_tablespaces t
where f.tablespace_name=t.tablespace_name
group by f.tablespace_name,t.contents) f
where free.tablespace_name=f.tablespace_name
group by f.tablespace_name,contents,Allocate,maxsize
union all
select f.tablespace_name,f.contents,f.Allocate,f.maxsize,f.allocate-nvl(sum(t.blocks*f.block_size),0) freesize,nvl(sum(t.blocks*f.block_size),0) used,f.maxsize-nvl(sum(t.blocks*f.block_size),0) available from v$tempseg_usage t,
(select f.tablespace_name,t.contents,t.block_size,sum(f.bytes) Allocate,sum(decode(f.AUTOEXTENSIBLE,'YES',f.maxbytes,f.bytes)) maxsize
from dba_temp_files f,dba_tablespaces t
where f.tablespace_name=t.tablespace_name
group by f.tablespace_name,t.contents,t.block_size) f
where t.tablespace(+)=f.tablespace_name
group by f.tablespace_name,f.contents,Allocate,maxsize)
/
select owner,object_type,count(*) cnt,sum(decode(status,'VALID',1,0)) valid,sum(decode(status,'VALID',0,1)) invalid from dba_objects
group by owner,object_type;

  
	
with snap as (select max(SNAP_ID) snap_id from dba_hist_snapshot)
select 	* from 
(select o.owner,o.object_name,o.SUBOBJECT_NAME,s.DB_BLOCK_CHANGES_TOTAL,s.DB_BLOCK_CHANGES_DELTA,LOGICAL_READS_TOTAL,LOGICAL_READS_DELTA,PHYSICAL_WRITES_TOTAL,PHYSICAL_WRITES_DELTA
from dba_objects o,
(select s1.dataobj#,s1.DB_BLOCK_CHANGES_TOTAL-s2.DB_BLOCK_CHANGES_TOTAL DB_BLOCK_CHANGES_TOTAL
,s1.DB_BLOCK_CHANGES_DELTA-s2.DB_BLOCK_CHANGES_DELTA DB_BLOCK_CHANGES_DELTA
,s1.LOGICAL_READS_TOTAL-s2.LOGICAL_READS_TOTAL LOGICAL_READS_TOTAL
,s1.LOGICAL_READS_DELTA-s2.LOGICAL_READS_DELTA LOGICAL_READS_DELTA
,s1.PHYSICAL_WRITES_TOTAL-s2.PHYSICAL_WRITES_TOTAL PHYSICAL_WRITES_TOTAL
,s1.PHYSICAL_WRITES_DELTA-s2.PHYSICAL_WRITES_DELTA PHYSICAL_WRITES_DELTA
from dba_hist_seg_stat s1, dba_hist_seg_stat s2,snap 
where s1.snap_id=snap.snap_id-0
and s2.snap_id=snap.snap_id-1
and s1.DBID=s2.DBID
and s1.INSTANCE_NUMBER=s2.INSTANCE_NUMBER
and s1.TS#=s2.TS#
and s1.OBJ#=s2.OBJ#) s
where  s.DATAOBJ#=o.DATA_OBJECT_ID
order by s.DB_BLOCK_CHANGES_DELTA desc)
where rownum<11;


and o.owner='ARADMIN'
or object_name in ('T148 T192');

exec dbms_logmnr_d.set_tablespace('SYSAUX')
exec dbms_logmnr.add_logfile(logfilename=>'/ora_arch_martip/martip_0985109577_0001_0000017979.arc',options=>DBMS_LOGMNR.NEW)
exec dbms_logmnr.add_logfile(logfilename=>'/ora_arch_remedyp/remedyp_0775757147_0001_0000000091.arc',options=>DBMS_LOGMNR.ADDFILE)
exec dbms_logmnr.add_logfile(logfilename=>'/ora_arch_remedyp/remedyp_0775757147_0001_0000000092.arc',options=>DBMS_LOGMNR.ADDFILE)
exec dbms_logmnr.start_logmnr(options=>DBMS_LOGMNR.DICT_FROM_ONLINE_CATALOG)
set pages 9999 lines 140 trims on 
col SEG_NAME form a40
select * fr
(select seg_owner, seg_name,count(*) cnt from v$logmnr_contents group by seg_owner, seg_name order by count(*) desc) where rownum<21;
exec dbms_logmnr.end_logmnr

/ora_arch_calypp/calypp_0666253489_0001_0000037300.arc
exec dbms_logmnr.add_logfile(logfilename=>'/ora_arch_calypp/calypp_0666253489_0001_0000037300.arc',options=>DBMS_LOGMNR.NEW)


!rm /u03/oradata/remedyp/redolog/remedyp_log5a.rdo /u02/oradata/remedyp/redolog/remedyp_log5b.rdo 
!rm /u03/oradata/remedyp/redolog/remedyp_log6a.rdo /u02/oradata/remedyp/redolog/remedyp_log6b.rdo 
!rm /u03/oradata/remedyp/redolog/remedyp_log7a.rdo /u02/oradata/remedyp/redolog/remedyp_log7b.rdo 
!rm /u03/oradata/remedyp/redolog/remedyp_log8a.rdo /u02/oradata/remedyp/redolog/remedyp_log8b.rdo 
!rm /u03/oradata/remedyp/redolog/remedyp_log9a.rdo /u02/oradata/remedyp/redolog/remedyp_log9b.rdo 
ALTER DATABASE ADD STANDBY LOGFILE group 5 ('/u03/oradata/remedyp/redolog/remedyp_log5a.rdo /u02/oradata/remedyp/redolog/remedyp_log5b.rdo') SIZE 1073741824;
ALTER DATABASE ADD STANDBY LOGFILE group 6 ('/u03/oradata/remedyp/redolog/remedyp_log6a.rdo /u02/oradata/remedyp/redolog/remedyp_log6b.rdo') SIZE 1073741824;
ALTER DATABASE ADD STANDBY LOGFILE group 7 ('/u03/oradata/remedyp/redolog/remedyp_log7a.rdo /u02/oradata/remedyp/redolog/remedyp_log7b.rdo') SIZE 1073741824;
ALTER DATABASE ADD STANDBY LOGFILE group 8 ('/u03/oradata/remedyp/redolog/remedyp_log8a.rdo /u02/oradata/remedyp/redolog/remedyp_log8b.rdo') SIZE 1073741824;
ALTER DATABASE ADD STANDBY LOGFILE group 9 ('/u03/oradata/remedyp/redolog/remedyp_log9a.rdo /u02/oradata/remedyp/redolog/remedyp_log9b.rdo') SIZE 1073741824;



select count(*),min(timestamp) min_timestamp,max(timestamp) max_timestamp,program,module,machinename,
case when regexp_like(upper(osuserid),'^(AC|G|N|Z)[0-9][0-9][0-9][0-9][0-9]') then 'accountable' else osuserid end username
 from bl.bl_tw_logonaudit
 where event='LOGON'
group by program,module,machinename,
case when regexp_like(upper(osuserid),'^(AC|G|N|Z)[0-9][0-9][0-9][0-9][0-9]') then 'accountable' else osuserid end
order by count(*) desc;  
 

select * from bl.bl_tw_logonaudit;

select distinct osuserid,
case when regexp_like(upper(osuserid),'^(AC|G|N|Z)[0-9][0-9][0-9][0-9][0-9]') then 'accountable' else osuserid end username
 from bl.bl_tw_logonaudit
 where event='LOGON'
--  and rownum<10000
order by osuserid;  


K/M/P/US

select 'rm '||name from
(select name from v$datafile where status in ('ONLINE SYSTEM') union all select name from v$tempfile union all select
name from v$controlfile union all select member from v$logfile);

select * from sysman.MGMT_BLACKOUTS where BLACKOUT_NAME like 'test_dev3%';

  
/damdt_data/ora_data
  
  ('EPORTALS_COMMON EPORTALS_CALENDAR')
  
mimt: set default tablespace to users and temporary tablespace temp

For each database execute:
sqlplus /nolog 

conn / as sysdba 
column repname new_value repname noprint;
select 'c1000536_'||i.host_name||'_'||d.name||'_'||to_char(sysdate,'yyyymmddhh24miss')||'.log' repname from v$database d,v$instance i;
spool &repname
set serveroutput on size 999999 lines 140 trims on 
select tablespace_name,contents from dba_tablespaces where tablespace_name in ('TEMP USERS');
alter database default tablespace users;
alter database default temporary tablespace temp;
declare 
  l_sql varchar2(2048);
begin 
for r0 in (select username,DEFAULT_TABLESPACE,TEMPORARY_TABLESPACE from dba_users 
  where (DEFAULT_TABLESPACE='SYSTEM' or TEMPORARY_TABLESPACE='SYSTEM')) loop 
	l_sql:='alter user "'||r0.username||'" ';
  if r0.DEFAULT_TABLESPACE='SYSTEM' and r0.username not in ('SYS SYSTEM') then 
    l_sql:=l_sql||' default tablespace users';
  end if;
  if r0.TEMPORARY_TABLESPACE='SYSTEM' then 
	l_sql:=l_sql||' temporary tablespace temp';
  end if;
  if r0.username not in ('SYS SYSTEM') or r0.TEMPORARY_TABLESPACE='SYSTEM' then 
	begin 
	  execute immediate l_sql;
	exception when others then 
	  dbms_output.put_line('<'||l_sql||'> error='||sqlerrm);
	end;
  end if;
end loop;
end;
/
exit


alter system set events '6502 trace name errorstack level 3';  



sammad: Recreate dbsnmp schema
cd $ORACLE_HOME/rdbms/admin
sqlplus / as sysdba 
@catnsnmp.sql
@catsnmp.sql
alter user dbsnmp identified by christian4tal account unlock profile TECHNICAL_USER_PROFILE;
grant execute on dbms_job to dbsnmp;





cd $ORACLE_HOME/rdbms/admin
export PATH=$PATH:/usr/local/bin
export ORAENV_ASK=NO
export ORACLE_SID=sammad
. oraenv
sqlplus /nolog <<__eof__
conn / as sysdba
column repname new_value repname noprint;
select 'C1000699_'||i.host_name||'_'||d.name||'_'||to_char(sysdate,'yyyymmddhh24miss')||'.log' repname from v\$database d,v\$instance i;
spool &repname
set serveroutput on size 999999 lines 140 trims on
@$ORACLE_HOME/rdbms/admin/catnsnmp.sql
@$ORACLE_HOME/rdbms/admin/catsnmp.sql
alter user dbsnmp identified by christian4tal;
exit
__eof__

select distinct host_name from (
select substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1)) target_name ,HOST_NAME 
from sysman.MGMT_TARGETS 
where TARGET_TYPE in ('oracle_database rac_database')
and regexp_like(substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1)),'(d|D)[0-9]*$'))
/

select distinct host_name from (
select upper(substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1))) target_name
from sysman.MGMT_TARGETS 
where TARGET_TYPE in ('oracle_database rac_database')
and regexp_like(substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1)),'(d|D)[0-9]*$'))

/



3-5675934061
INC000001006815
alter system set events '6502 trace name ERRORSTACK level 3';
alter system set events '6502 trace name context off';


begin 
  for r1 in (select owner,object_name from dba_objects where object_type in ('VIEW TABLE') and owner in ('LOANIQ')) loop 
    begin 
      execute immediate 'grant select on "'||r1.owner||'"."'||r1.object_name||'" to LOANIQ_RW';
    exception when others then 
      dbms_output.put_line(sqlerrm||' grant  select on "'||r1.owner||'"."'||r1.object_name||'" to LOANIQ_RW');
    end;
  end loop;
end;
/
begin 
  for r1 in (select owner,object_name from dba_objects where object_type in ('TABLE') and owner in ('LOANIQ')) loop 
    begin 
      execute immediate 'grant insert,update,delete on "'||r1.owner||'"."'||r1.object_name||'" to LOANIQ_RW';
    exception when others then 
      dbms_output.put_line(sqlerrm||' grant  insert,update,delete on "'||r1.owner||'"."'||r1.object_name||'" to LOANIQ_RW');
    end;
  end loop;
end;
/

/net/is-nfsorad/cfs/is-nfsorad/ora_export
ln -s /net/is-nfsorad/cfs/is-nfsorad/ora_export ~/oranfs

select lower(target_name) from 
(select substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1)) target_name from
(select substr(target_name,1,decode(instr(target_name,'_'),0,length(target_name),instr(target_name,'_')-1)) target_name
from sysman.MGMT_TARGETS  where TARGET_TYPE in ('oracle_database rac_database')))
where lower(target_name) not in  (select lower(db_name) from bl.DATABASE_DIVINF@twp);


-- gridp --
select lower(target_name),host_name from 
(select substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1)) target_name,host_name from
(select substr(target_name,1,decode(instr(target_name,'_'),0,length(target_name),instr(target_name,'_')-1)) target_name,host_name
from sysman.MGMT_TARGETS  where TARGET_TYPE in ('oracle_database rac_database')))
where (lower(target_name),host_name) not in  (select lower(service_name),nvl(host_name,'ora_'||lower(sid_name)) from sweeper.DATABASES)
and (lower(target_name),host_name) not in  (select lower(sid_name),nvl(host_name,'ora_'||lower(sid_name)) from sweeper.DATABASES);

select target_name from 
(select distinct upper(substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1))) target_name
from sysman.MGMT_TARGETS
where TARGET_TYPE in ('oracle_database rac_database')
-- and regexp_like(substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1)),'(d|D)[0-9]*$')
)
where target_name not in (select distinct DB_NAME from bl.DATABASE_DIVINF@twp)
order by 1;

select target_name from
(select distinct upper(substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1))) target_name
from sysman.MGMT_TARGETS
where TARGET_TYPE in ('oracle_database rac_database')
-- and regexp_like(substr(target_name,1,decode(instr(target_name,'.'),0,length(target_name),instr(target_name,'.')-1)),'(d|D)[0-9]*$')
)
where target_name not in (select distinct DB_NAME from bl.DATABASE_DIVINF@twp)
order by 1;

for f in $(ls -1 p1*11203*Solaris86-64*.zip) ; do
n=$(echo $f|awk '{print substr($1,1,length($f)-4);}')
mkdir $n 
cd $n 
unzip ../$n.zip 
cd ..
done

set pages 9999 lines 140 trims on
col owner form a20
-- check object count --
select owner,object_type,count(*) cnt,sum(decode(status,'VALID',1,0)) valid,sum(decode(status,'VALID',0,1)) invalid
from dba_objects where object_name not like 'BIN$%'
and owner in ('AC CALYPP CALYPSO CALYPSO_MIDTIER CALYPSO_READ D35209 DM DM_SYS G99854 IM NORDEA SEOP_READ TWCALYP')
group by owner,object_type
order by owner,object_type;
-- after 11.2.0.3 olcore have 83 lobs there are 4 lobs that exists in dba_objects and not in dba_lobs
-- check constraints status --
select owner,CONSTRAINT_TYPE,STATUS,DEFERRABLE,DEFERRED,VALIDATED,GENERATED,INVALID,count(*) cnt from dba_constraints where CONSTRAINT_TYPE in ('U P R')
and owner in ('AC CALYPP CALYPSO CALYPSO_MIDTIER CALYPSO_READ D35209 DM DM_SYS G99854 IM NORDEA SEOP_READ TWCALYP')
and CONSTRAINT_name not like 'BIN$%'
group by owner,CONSTRAINT_TYPE,STATUS,DEFERRABLE,DEFERRED,VALIDATED,GENERATED,INVALID
order by owner,CONSTRAINT_TYPE,STATUS,DEFERRABLE,DEFERRED,VALIDATED,GENERATED,INVALID;
-- check trigger status --
select OWNER,TRIGGER_TYPE,STATUS,count(*) from dba_triggers where 1=1
and owner in ('AC CALYPP CALYPSO CALYPSO_MIDTIER CALYPSO_READ D35209 DM DM_SYS G99854 IM NORDEA SEOP_READ TWCALYP')
group by OWNER,TRIGGER_TYPE,STATUS;



set pages 9999 lines 140 trims on
col GRP_NAME form a20
col GRP_NAME form a12
col CAB_MANAGER_LOGIN form a24
col CAB_MANAGER___CHANGE_CO_ORD__ form a8
col STAT form a10
col ASSIGNEE form a24
col ASSIGNED_TO form a8
select chg.infrastructure_change_id change_id,t.task_id,t.assigned_to,t.assignee
     ,chg.change_request_status
     ,decode(chg.change_request_status,'12 Canceled 11 Closed 10 Rejected'
        ,'9 Rejected 8 Pending 7 Implementation in progress 6 Scheduled'
        ,'5 Scheduled for Approval 4 Scheduled For Review 3 Planning in progress'
        ,'1 Request For Authorization',0,'Draft',chg.change_request_status) chg_stat
        ,t.status
        ,decode(t.status,7000,'Bypassed',6000,'Completed',4000,'Work in progress'
        ,3000,'Pending',2000,'Assigned',1000,'Staged',t.status) stat
        ,case when (chg.change_target_date/(24*3600))+2440588<5373484 then
        to_date(to_char(trunc((chg.change_target_date/(24*3600))+2440588))||'-'
        ||to_char(mod(chg.change_target_date,24*3600)),'J-SSSSS') else null end target_date
        ,case when (t.actual_start_date/(24*3600))+2440588<5373484 then
        to_date(to_char(trunc((t.actual_start_date/(24*3600))+2440588))||'-'
        ||to_char(mod(t.actual_start_date,24*3600)),'J-SSSSS') else null end start_date
        ,case when (t.actual_end_date/(24*3600))+2440588<5373484 then
        to_date(to_char(trunc((t.actual_end_date/(24*3600))+2440588))||'-'
        ||to_char(mod(t.actual_end_date,24*3600)),'J-SSSSS') else null end end_date
        ,t.assignee_group_id
        ,chg.description changesummary
        ,t.summary tasksummary
        ,CAB_MANAGER___CHANGE_CO_ORD__
        ,chg.cab_manager_login
        ,grp.c301363100 grp_name
from aradmin.TMS_TASK t
        ,aradmin.chg_infrastructure_change chg
        ,aradmin.t254 grp
where 1=1
  and t.rootrequestid=chg.infrastructure_change_id
  and t.assignee_group_id=grp.c301242000
  and grp.c301363100='System DBA'
  and t.assigned_to='g99854'
  and ((t.actual_end_date/(24*3600))+2440588<5373484
  and to_date(to_char(trunc((t.actual_start_date/(24*3600))+2440588))||'-'
      ||to_char(mod(t.actual_start_date,24*3600)),'J-SSSSS') between to_date('20120701 yyyymmddhh24miss') and to_date('20120801 yyyymmddhh24miss'))
--   and t.status not in (7000,6000)
--   and (t.visible <> '0' or t.visible is null)
order by chg.change_target_date,chg.infrastructure_change_id,t.sequence;




if [ -e ~/motd ] ; then cat ~/motd;stat motd|awk '{if($1=="Modify:")print "Motd last modified " $2 " " substr($3,1,8);}'; fi
# set up user directories
user=$(who am i|awk '{print $1}')
eval userhome=~$user
if [[ -x "$userhome/oracleprofile" ]] ; then
. $userhome/oracleprofile
else
  if [[ -x "/net/is-nfsorad/cfs/is-nfsorad/ora_export/${user}/oracleprofile" ]] ; then
    . /net/is-nfsorad/cfs/is-nfsorad/ora_export/${user}/oracleprofile
  fi
fi

net use x: \\VDD1XF0077\S64\CMCC-DK-DB-ORACLE

col segment_owner form a12 
col segment_name form a32 
col alloc_mb form 999g999 
col used_mb form 999g999 
col reclaim_mb form 999g999 
col pctsave form 99d99 
SELECT segment_owner,segment_name,
round(allocated_space/1024/1024,1) alloc_mb,
round( used_space/1024/1024, 1 ) used_mb,
round( reclaimable_space/1024/1024) reclaim_mb,
round(reclaimable_space/allocated_space*100,0) pctsave,
recommendations
FROM TABLE(dbms_space.asa_recommendations());

select * from (select OWNER,NAME,type,SHARABLE_MEM from v$db_object_cache order by SHARABLE_MEM desc) where rownum<11;


 

create tablespace ggsmgr logging datafile '/u02/oradata/critt/datafile/ggsmgr_1.dbf' size 513M autoextend on next 512m maxsize 16385m
  extent management local autoallocate segment space management auto;

create user GGSMGR identified by ggmanager2  --- ora0ggpass
  default tablespace ggsmgr -- or ggsmgr_t_8m
  temporary tablespace temp
;


"SYS_SQLPROF_0139c50a45f00000" sql_id 121tc85dkfv98


MUREX1_INT.MLOG$_MXT_PL_VAR_REP MUREX.MXT_PL_VAR_REP@TWDDB 2012-09-19 11:10:48
97666 4000-01-01 00:00:00 4000-01-01 00:00:00
MUREX1_INT.MLOG$_MXT_SI_STATIC_REP MUREX.MXT_SI_STATIC_REP@TWDDB 2012-09-19
02:30:07 670 4000-01-01 00:00:00 4000-01-01 00:00:00
MUREX1_INT.MLOG$_MXT_TRADE_SI_REP MUREX.MXT_TRADE_SI_REP@TWDDB 2012-09-19
14:42:04 38 4000-01-01 00:00:00 4000-01-01 00:00:00

nohup ~/dbadmin/backup/db_backup_ha.sh BACKUP_ARCHIVE_ONLY=YES CHANNELS=1 CAT_USER=uc4p &
nohup ~/dbadmin/backup/db_backup_ha.sh LEVEL0=YES CHANNELS=1 CAT_USER=uc4p BACKUP_DB_ONLY=YES &


setfacl -m user:g99854:rwx test

find  ~oracle/dbadmin/alert_monitor -name severity_1.pat -exec ls -l {} \;

db-sammad-a - dwsat4p
db-calypr - db-calypr1
db-calypr - db-calypr2
db-tipt - tipadv
db-twt-a - twmp
db-cmccsmt-a - cmccsmx
db-infod-a - 110
db-infod-a - 112
db-orclt-a - twmx

rm -rf ~/dbadmin/alert_monitor
/net/dkd1mr7913/export/install/media/oracle/scripts/alert_monit_install/install.sh
~/dbadmin/alert_monitor/set_demo_monitoring.sh
~/dbadmin/alert_monitor/monitor.sh start


grep -v "^#" /me01/oracle/itm_logs/itm_log|awk -F, '{print "./postzmsg -f /me01/oracle/dbadmin/alert_monitor/postzmsg.cfg hostname=\""$3"\" msgid=\"ORANCM004E\" group=\"Service Centre\" \""$4"_"$5"\" \"Alertlog Monitor\""}'|sort|uniq >am.sh



oracle@db-tipt-a:/u01/app/oracle/product/10.2.0.4/db_1/ccr/bin% cd emCCR
pfksh: emCCR: not a directory
oracle@db-tipt-a:/u01/app/oracle/product/10.2.0.4/db_1/ccr/bin% ./emCCR collect
Oracle Configuration Manager - Release: 10.3.7.0.0 - Production
Copyright (c) 2005, 2012, Oracle and/or its affiliates.  All rights reserved.
------------------------------------------------------------------
Unable to determine if mandatory packages available.
Unable to establish connection to Oracle Configuration Manager server.
Oracle Configuration Manager endpoint hostname (dkcmwm10537738) is unknown.

Collection and upload failed.

$ORACLE_HOME/ccr/bin/emocmrsp -repeater http://CMD1CS0260:8888

declare 
  procedure dosql(p_sql in varchar2) as 
  begin
    execute immediate p_sql;
  exception when others then 
    dbms_output.put_line(sqlerrm||' '||p_sql);   
  end; 
begin 
for r1 in (select owner,table_name from dba_tables where table_name in 
    ('AJPPV ABLOB APPF AH APD ACMT AHG AHGH AJPP AJPPA'
    ,'AJPPC APDC AV AWS ACV AFC RT RH AJPPF AJPVA AJPPO AJPOV AJPOP AJPFV ARB' )) loop 
  dosql('alter table '||r1.owner||'.'||r1.table_name||' enable row movement');
  dosql('alter table '||r1.owner||'.'||r1.table_name||' shrink space compact');
  dosql('alter table '||r1.owner||'.'||r1.table_name||' shrink space');
end loop; 
end;
/

declare 
  procedure dosql(p_sql in varchar2) as 
  begin
    execute immediate p_sql;
  exception when others then 
    dbms_output.put_line(sqlerrm||' '||p_sql);   
  end; 
begin 
for r1 in (select i.owner,i.index_name,round(s.bytes/1024/1024) mb from dba_indexes i,dba_segments s
 where s.owner=i.owner and s.segment_name=i.index_name and index_type<>'LOB'
and i.table_name in ('AJPPV ABLOB APPF',/* 'AH', */ 'APD ACMT AHG AHGH AJPP AJPPA'
,'AJPPC APDC AV AWS ACV AFC RT'/* ,'RH' */ ,'AJPPF AJPVA AJPPO AJPOV AJPOP AJPFV ARB')) loop
  dosql('alter index '||r1.owner||'.'||r1.index_name||' rebuild online compute statistics');
  end loop; 
end;
/

declare 
  procedure dosql(p_sql in varchar2) as 
  begin
    execute immediate p_sql;
  exception when others then 
    dbms_output.put_line(sqlerrm||' '||p_sql);   
  end; 
begin 
for r1 in (select i.owner,i.index_name,round(s.bytes/1024/1024) mb from dba_indexes i,dba_segments s
 where s.owner=i.owner and s.segment_name=i.index_name and index_type<>'LOB'
and i.table_name in ('AH')) loop
  dosql('alter index '||r1.owner||'.'||r1.index_name||' rebuild online compute statistics');
  end loop; 
end;
/


./postzmsg -f /me01/oracle/dbadmin/alert_monitor/postzmsgtest.cfg -r CLEAR hostname"db-bmp-3" msgid="ORANCM004E" group="System DBA" "db-bmp-3" "Alertlog Monitor"

set long 999999 lines 9999 pages 9999 heading off trims on feedback off echo off 
col output form a9999
spool awrrpt_3_52551_52581.html 
select output from table(dbms_workload_repository.awr_report_html(3972617280,3,52551,52581));
spool off 


## på primær side
## Når SID og service er det samme 
# /net/js/export/install/media/oracle/scripts/autospace/v3/inst.sh <SID>
## Når SID og service er det samme 
# /net/js/export/install/media/oracle/scripts/autospace/v3/inst.sh <SID>/<service>

## på dataguard side
## Når SID og service er det samme 
# /net/js/export/install/media/oracle/scripts/autospace/v3/inst_dg.sh <SID>
## Når SID og service er det samme 
# /net/js/export/install/media/oracle/scripts/autospace/v3/inst_dg.sh <SID>/<service>


/net/js/Nordea/scripts/postz -h $(hostname) -i 2:0:0:0
/net/js/Nordea/scripts/postz -h $(hostname) -i 0:0:0:10

/opt/VRTSvcsone/bin/halogin -endallsessions
/opt/VRTSvcsone/bin/halogin -user g46480@ldap -domaintype ldap
/opt/VRTSvcsone/bin/hagrp -freeze db-remep-cb-SG
/opt/VRTSvcsone/bin/hagrp -unfreeze db-retd-cb-SG
/opt/VRTSvcsone/bin/hagrp -display|awk '{print $1}'|sort -u 

/opt/VRTSvcsone/bin/hares -display -grp db-monitt-cb-SG | awk '{print $1}' | sort -u 
/opt/VRTSvcsone/bin/hares -display db-damdt-ora-RES -grp db-remep-cb-SG -attribute State
/opt/VRTSvcsone/bin/hares -display db-damdt-ora-RES -grp db-damdt-cb-SG -attribute Home

/opt/VRTSvcsone/bin/hares -display db-damdt-netl-RES
# /opt/VRTSvcsone/bin/hares -offline db-trmd-netl-RES -sys dkd1mr4040
# /opt/VRTSvcsone/bin/hares -offline -ignoreparent  db-monitt-ora-RES -sys dkd1mr4060

# /opt/VRTSvcsone/bin/hares -offline -ignoreparent db-damdt-ora-RES -sys dkd1mr4022
# /opt/VRTSvcsone/bin/hares -offline -ignoreparent db-damdt-netl-RES -sys dkd1mr4022


# /opt/VRTSvcsone/bin/hares -online db-damdt-ora-RES -sys dkd1mr4022
/opt/VRTSvcsone/bin/hares -online db-damdt-netl-RES -sys dkd1mr4022

/opt/VRTSvcsone/bin/hares -offline db-gsimdp-gcagent-ap-RES -sys dkd1mr1070


/opt/VRTSvcsone/bin/hares -modify db-damdt-cb-SG.db-damdt-ora-RES Home /u01/app/oracle/product/11.2.0.3/dbhome_1
/opt/VRTSvcsone/bin/hares -modify db-damdt-cb-SG.db-damdt-netl-RES Home /u01/app/oracle/product/11.2.0.3/dbhome_1

/opt/VRTSvcsone/bin/hares -modify db-imt-cb-SG.db-imt-ora-RES Home /u01/app/oracle/product/9.2.0/db_1
/opt/VRTSvcsone/bin/hares -display db-imt-cb-SG.db-imt-ora-RES

db-calypp-cb-SG


E:\ORADATA\ETLT\DATAFILES\SYSTEM01.DBF
CREATE TABLESPACE etl_t DATAFILE
  'E:\ORADATA\ETLT\DATAFILES\etl_t_1.dbf' SIZE 513m AUTOEXTEND ON NEXT 512m  MAXSIZE 16385Mexi
  EXTENT MANAGEMENT LOCAL AUTOALLOCATE  SEGMENT SPACE MANAGEMENT AUTO;
CREATE TABLESPACE etl_i DATAFILE
  'E:\ORADATA\ETLT\DATAFILES\etl_i_1.dbf' SIZE 513m AUTOEXTEND ON NEXT 512m  MAXSIZE 16385M
  EXTENT MANAGEMENT LOCAL AUTOALLOCATE  SEGMENT SPACE MANAGEMENT AUTO;
alter database add standby logfile group 7('/u04/oradata/trmp/ora_redo/stdby7a.log /u05/oradata/trmp/ora_redo/stdby7b.log') size 4294967296;
alter database add standby logfile group 8('/u04/oradata/trmp/ora_redo/stdby8a.log /u05/oradata/trmp/ora_redo/stdby8b.log') size 4294967296;
alter database add standby logfile group 9('/u04/oradata/trmp/ora_redo/stdby9a.log /u05/oradata/trmp/ora_redo/stdby9b.log') size 4294967296;

alter system set standby_file_management='MANUAL'; 
select 'alter database rename file '''||name
||''' to ''/u09/oradata/trmp/datafiles/'||substr(name,instr(name,'/',-1)+1)||''';'
from v$datafile
where name like '/trmp_data/ora_data/%.dbf';
alter system set standby_file_management='AUTO'; 
  
declare 
cursor c1 is select 1 cnt from dba_tables where owner='ARADMIN' and table_name='H992'; 
b_found  boolean:=false; 
begin 
execute immediate 'create view aradmin.H864 as select * from dual';
execute immediate 'create view aradmin.H865 as select * from dual';
execute immediate 'create view aradmin.H866 as select * from dual';
while not b_found loop 
  for r1 in c1 loop
    execute immediate 'alter table aradmin.h992 drop(T1,U1)';
	b_found:=true; 
  end loop;
end loop; 
end;
/
EXEC DBMS_System.ksdwrt(2,'ORA-00600: internal error code, arguments: [ARNES_TEST], [JUST CLOSE INCIDENT], [INCIDENT TEST], [], [], [], [], []'); 
 select 'EXEC DBMS_SYSTEM.set_ev(si=>'||sid||',se=>'||serial#||',ev=>10046,le=>12,nm=>'' '')' from  v$session where upper(machine) like 'CMA1CS0327%'

!rm /u02/oradata/damdt/controlfiles/damdt_1.ctl /u03/oradata/damdt/controlfiles/damdt_2.ctl /u02/oradata/damdt/datafiles/*_1.dbf /u03/oradata/damdt/redologs/redo*rdo /u02/oradata/damdt/redologs/redo_*.rdo

CREATE DATABASE damd1t
MAXINSTANCES 8
MAXLOGHISTORY 1
MAXLOGFILES 16
MAXLOGMEMBERS 3
MAXDATAFILES 1000
DATAFILE '/u02/oradata/damdt/datafiles/system_1.dbf' SIZE 4097M REUSE AUTOEXTEND ON NEXT 512m MAXSIZE 16385M EXTENT MANAGEMENT LOCAL
SYSAUX DATAFILE '/u02/oradata/damdt/datafiles/sysaux_1.dbf' SIZE 4097M REUSE AUTOEXTEND ON NEXT 128M MAXSIZE 16385M
SMALLFILE DEFAULT TEMPORARY TABLESPACE TEMP TEMPFILE '/u02/oradata/damdt/datafiles/temp_1.dbf' SIZE 4097M REUSE AUTOEXTEND ON NEXT 128M MAXSIZE 16385M
SMALLFILE UNDO TABLESPACE UNDOTBS1 DATAFILE '/u02/oradata/damdt/datafiles/undotbs1_1.dbf' SIZE 4097M REUSE AUTOEXTEND ON NEXT 128M MAXSIZE 16385M
CHARACTER SET AL32UTF8
NATIONAL CHARACTER SET AL16UTF16
LOGFILE
GROUP 1 ('/u02/oradata/damdt/redologs/redo_1a.rdo /u03/oradata/damdt/redologs/redo_1b.rdo') SIZE 512M,
GROUP 2 ('/u02/oradata/damdt/redologs/redo_2a.rdo /u03/oradata/damdt/redologs/redo_2b.rdo') SIZE 512M,
GROUP 3 ('/u02/oradata/damdt/redologs/redo_3a.rdo /u03/oradata/damdt/redologs/redo_3b.rdo') SIZE 512M
USER SYS IDENTIFIED BY t3triton user system IDENTIFIED BY t6triton;

CREATE SMALLFILE TABLESPACE "USERS" LOGGING DATAFILE '/u02/oradata/damdt/datafiles/users_1.dbf' SIZE 4097m REUSE AUTOEXTEND ON NEXT 512m MAXSIZE 16385M EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT  AUTO;
ALTER DATABASE DEFAULT TABLESPACE "USERS";
spool off

/net/dkd1mr7913/export/install/media/oracle/sun/clone_tree/11.2.0.3/scripts/CreateDB

@CreateDB.sql &newsid
@CreateDBFiles.sql &newsid
@CreateDBCatalog.sql &newsid
ok @JServer.sql &newsid 
@xdb_protocol.sql &newsid
@ordinst.sql &newsid
@interMedia.sql &newsid
-- @apex.sql &newsid
@lockAccount.sql &newsid
@postDBCreation.sql &newsid

 chmod 755 /u01 /u01/app /u01/app/oracle /u01/app/oracle  /u01/app/oracle/products /u01/app/oracle/products/11.2.0.3 /u01/app/oracle/products/11.2.0.3/client_1
find /u01/app/oracle/products/11.2.0.3/client_1 -type d -exec chmod 755 {} \;

Unable to get some data for Event Mangement Report.
in the tab 4. Load pr. Servers - I'm not able to retrieve data for the last month only. Then the data returned is only one line with the amount of incidents that month, instead of a list of incidents related to servers. 

The report is found in BO in the below path: 
CMCC--> Service Reporting --> Report Samples --> 2. Incidents

Name of report:
Event Management_Peter Kofoed Madsen_10.10.2012



File containing tables of previous day's Remedy incidents per group (named "Incidents assigned to DCO_Last 24 hours time-specific2013-08-09-07...") is not being deliverd to CMCC Servicecenter (folder \\s64a603\CMIOServiceReporting\1. Operational Reports (Standard)\2. Incidents\Incidents assigned to DCO groups (selection by Jørgen Wriedt)) 
File is required for morning reports to mgmt.

---------------------------------------
It seems that both the scheduled reports delivered every Mondays and the daily report delivered Tuesday-Friday are not delivered from Business Objects:

- Incidents assigned to DCO_Last 72 hours time-specific
- Incidents assigned to DCO_Last 24 hours time-specific

Both report can be found in BO in this path:
CMCC Service Reporting --> 1. Operational Reports (standard) --> 2. incidents --> Incidents assigned to DCO_Jørgen wriedt

If report are delivered correctly they will automatically be stored in the below Fileshare path:
\\S64A603\cmioservicereporting\1. Operational Reports (Standard)\2. Incidents\Incidents assigned to DCO groups (selection by Jørgen Wriedt)

select to_char(sysdate,'hh24:mi') time
,round(sum(bytes)/1024/1024) total
,round(sum(case when CHECKPOINT_CHANGE#>2343880485692 then bytes else 0 end)/1024/1024) restored
,round(sum(case when CHECKPOINT_CHANGE#>2343880485692 then bytes else 0 end)/sum(bytes)*100,2) pct from v$datafile_header 

TIME TOTAL RESTORED PCT
----- ---------- ---------- ----------
23:13 58395503 28564395 48.92


select to_char(sysdate,'hh24:mi') time
,58395503 total
,round(sum(case when CHECKPOINT_CHANGE#>2343880485692 then bytes else 0 end)/1024/1024) restored
,round(sum(case when CHECKPOINT_CHANGE#>2343880485692 then bytes else 0 end)/(58395503*1023*1024)*100,2) pct from v$datafile_header 



useradd -d /app_ogg/ogg -g 5000 -m -r -c "Golden Gate user" ogg 
chown ogg:oinstall /ora_ogg /app_ogg
cd /app_ogg
tar xvzf /net/js/export/install/media/oracle/linux_x86_64/goldengate/gg112107_Linux-x86-64.tar


/me01p/tw/sql/dl_mcdm_trade_prob.sql
/me01p/tw/scripts/dl_mcdm_trade_ldg_mv_1615.sh
/me01p/tw/scripts/dl_mcdm_trade_ldg_mv_1615.sh
/me01p/tw/scripts/dl_mcdm_trade_calypso_fu_mv_22.sh
/me01p/tw/scripts/dl_mcdm_trade_calypso_repo_mv_22.sh
/me01p/tw/scripts/dl_mcdm_trade_abasec.sh
/me01p/tw/scripts/dl_mcdm_trade_calypso_fu_mv_18.sh
/me01p/tw/scripts/dl_mcdm_trade_calypso_repo_mv_18.sh


mvxmaterializefifoprice 
henter trades! 

VAR P_TB_LEGAL_COUNTRY varchar2(4)
VAR P_INSTRUMENT_SU_KEY  number 
VAR P_SIGN NUMBER 
var p_market_su_key number
BEGIN 
:P_SIGN:=1;
:P_INSTRUMENT_SU_KEY:=95471296;
:P_TB_LEGAL_COUNTRY='DK';
:p_market_su_key:=18624927;
END; 
/
    
goldengate maintanance:
gg_maintenance on
mode manager 
gg_maintenance off
mode ALL

enawk '{if ($1=="MAP") {print $1 " " toupper($2) " " $3 " " $4} else if ($1=="EXTTRAIL"){print "-- " $0} else {print $0}}' r_inmccp.prm


STATUS ,ENV ,LOGICAL_NAME ,DESCRIPTION ,PORT ,HOST_NAME ,SERVICE_NAME ,BL_INSTALLED ,DM_COMP 
,DLCM_COMP ,DATAGUARD_COMP ,REORG_COMP ,STAT_COMP ,DISK_COMP ,JL_COMP ,AQ_COMP ,AUDIT_COMP 
,LOGON_COMP ,PW ,BUSINESS_AREA ,VENDOR ,DATABASE_SIZE ,RESPONSIBLE ,CONTACT ,DBA_CONTACT 
,COMMENTS ,CONNECT_INFO ,EXTRACT_MVIEW ,CREATED ,UPDATED_BY ,LAST_UPDATED 

select * from v$session where sid in (select BLOCKING_SESSION from v$session where BLOCKING_SESSION_STATUS='VALID')
or sid in (select sid  from v$session where BLOCKING_SESSION_STATUS='VALID');

select table_owner,table_name,index_name,listagg(column_name,',') within group(order by column_position) cols from dba_ind_columns where table_name in ('RISK_PROD_AUTOREG','RISK_TEST_AUTOREG') group by table_owner,table_name,index_name;

select table_owner,table_name,index_name,wmsys.wm_concat(column_name) cols from dba_ind_columns where table_name in ('RISK_PROD_AUTOREG','RISK_TEST_AUTOREG') group by table_owner,table_name,index_name;



spool calypt_awr_2014-01-16-1500-1tbkyhp6curdt.html 
select output from table(dbms_workload_repository.awr_sql_report_html(2404505770,1,1136,1137,'1tbkyhp6curdt'));
spool calypt_awr_2014-01-16-1500-fbmjfhw4ust7j.html 
select output from table(dbms_workload_repository.awr_sql_report_html(2404505770,1,1136,1137,'fbmjfhw4ust7j'));
spool calypt_awr_2014-01-16-1500-a3gyjbq65mwuq.html 
select output from table(dbms_workload_repository.awr_sql_report_html(2404505770,1,1136,1137,'a3gyjbq65mwuq'));
spool calypt_awr_2014-01-16-1500-duhjauqr4z4q6.html 
select output from table(dbms_workload_repository.awr_sql_report_html(2404505770,1,1136,1137,'duhjauqr4z4q6'));
spool calypt_awr_2014-01-16-1500-d9ppv6yvapk3a.html 
select output from table(dbms_workload_repository.awr_sql_report_html(2404505770,1,1136,1137,'d9ppv6yvapk3a'));


select dbms_metadata.get_ddl('MATERIALIZED_VIEW_LOG',log_table,log_owner)||';' from dba_mview_logs where log_owner in ('MARTINI')

/usr/ucb/ps auxwww 


grant execute on DBMS_LOB to MDSYS;
grant execute on DBMS_LOB to XDB;
grant select on all_users  to xdb;
e

'AC','CALYPP','CALYPSO','CALYPSO_MIDTIER','CALYPSO_READ','D35209','DM','DM_SYS','G99854','IM','NORDEA','SEOP_READ','TWCALYP'

('BL','IDM','DBADMIN','G46480','XS$NULL','ORACLE_OCM','DIP','DBSNMP','SI_INFORMTN_SCHEMA','ORDPLUGINS','APPQOSSYS','XDB','WMSYS','EXFSYS','ANONYMOUS','ORDSYS','ORDDATA','MDSYS','SYSTEM','SYS'','OUTLN') 


declare 
begin 
for r0 in (
select distinct substr(subscription_name,2,instr(subscription_name,'.')-3)||'.'||substr(subscription_name,instr(subscription_name,'.')+2,instr(subscription_name,':')-instr(subscription_name,'.')-3) queue
,substr(subscription_name,instr(subscription_name,':')+2,length(subscription_name)-instr(subscription_name,':')-2) subscriber
from DBA_SUBSCR_REGISTRATIONS@expsrc order by 1) loop
dbms_output.put_line('dbms_aqadm.add_subscriber(queue_name=>'''||r0.queue||''',subscriber =>sys.aq$_agent('''||r0.subscriber||''',null,null));');
end loop; 
for r0 in (select distinct substr(subscription_name,2,instr(subscription_name,'.')-3)||'.'||substr(subscription_name,instr(subscription_name,'.')+2,instr(subscription_name,':')-instr(subscription_name,'.')-3) queue
,substr(subscription_name,instr(subscription_name,':')+2,length(subscription_name)-instr(subscription_name,':')-2) subscriber
,location_name
,user_context
from DBA_SUBSCR_REGISTRATIONS@expsrc order by 1) loop
dbms_output.put_line('dbms_aq.register(sys.aq$_reg_info_list(sys.aq$_reg_info('''||r0.queue||':'||r0.subscriber||''',dbms_aq.namespace_aq,'''||r0.location_name||''',hextoraw('''||r0.user_context||'''))),1);');
end loop; 
end;
/ 

conn acc/acc@//ora_cocop:1521/COCOP

audit alter system,cluster,context,database link,dimension,directory,index,materialized view,outline,procedure,profile,public database link, public synonym,role,rollback segment,sequence,synonym,system audit,system grant,table,tablespace,trigger, type,user,view;

Christiansbro
Strandgade 3
1401 København K
CVR nr.: 20 41 88 42

Drives af:
ISS Facility Service A/S
Møntmestervej nr. 31
DK-2400 København NV
Tlf: +45 38 17 17 17
CVR nr.: 14 40 60 42 


twp actions 
1. check parameters standby/primary 
   done
2. check advisors 
2.1 addm 
2.2 segment space 
3. check configuration 
4. prepare weekly performance report 


twp 
log shift less than 5 min!

select 'alter user '||name||' identified by values '''||nvl(spare4,password)||''' account unlock;' from user$ where name='SYSTEM';

starttid 
sluttid 
script name 
script version Status       Local     Remote                    Network

-------------------------------------------------------------------------------
OK           H:        \\S64A603\G46480$         Microsoft Windows Network
OK           R:        \\S60a603\public          Microsoft Windows Network
OK           Z:        \\s64a603\cmcc-dk-db-oracle
                                                Microsoft Windows Network
The command completed successfully.

host 
status
description
logfile (clob) 

DBADMIN
create table dbadmin.execution_log
(exec_start date
,exec_end date 
,script_name varchar2(256)
,script_version varchar2(256)
,returncode number
,exec_comment varchar2(4000)
,log_file clob store in ) tablespace BL_T_256K;

70261528

create or replace package check_mlog AUTHID CURRENT_USER as 
  -- Created by Arne Moeller/System DBA 
  TYPE t_check_mlog_row IS RECORD (
    owner      VARCHAR2(30),
    table_name VARCHAR2(30),
    bytes      number,
    first_snap date,
    last_snap  date,
    cnt        number
  );
  TYPE tt_check_mlog_row IS TABLE OF t_check_mlog_row;
  FUNCTION check_mlog RETURN tt_check_mlog_row PIPELINED;
END check_mlog;
/
create or replace package body check_mlog is 
  -- Created by Arne Moeller/System DBA 
  FUNCTION check_mlog RETURN tt_check_mlog_row PIPELINED is 
    type tt_owner table of varchar2(30) index by pls_integer; 
	type tt_table table of varchar2(30) index by pls_integer; 
	type tt_bytes table of number index by pls_integer; 
	t_owner tt_owner;
	t_table tt_table;
	t_bytes tt_bytes;
    r_check_mlog_row t_check_mlog_row;
    l_first_snap date;
    l_last_snap date;
    l_cnt number;
  begin
    dbms_application_info.set_module('dbadmin.check_mlog','check_mlog');
    select ml.log_owner,ml.log_table,s.bytes
	  bulk collect into t_owner,t_table,t_bytes
        from dba_mview_logs ml,dba_segments s 
       where ml.log_owner=s.owner 
         and ml.log_table=s.segment_name;

    for i0 in t_owner.first..t_owner.last loop
	  commit;
      execute immediate 'select max(snaptime$$),min(snaptime$$),count(*) from "'||t_owner(i0)||'"."'||t_table(i0)||'"' into l_first_snap,l_last_snap,l_cnt;
      r_check_mlog_row.owner:=t_owner(i0);
      r_check_mlog_row.table_name:=t_table(i0);
      r_check_mlog_row.bytes:=t_bytes(i0);
      r_check_mlog_row.first_snap:=l_first_snap;
      r_check_mlog_row.last_snap:=l_last_snap;
      r_check_mlog_row.cnt:=l_cnt;
      pipe row(r_check_mlog_row);
    end loop;
    return;
    dbms_application_info.set_module(null,null);
  end check_mlog;
END check_mlog;
/  

DECLARE
  l_task_name VARCHAR2(30):='G46480_tune_03';
  l_task VARCHAR2(30);
  l_sql CLOB;
  l_out clob;
  i0 number:=1;
BEGIN
  l_sql:='select loebenr,trans_reg_dato,koeb_salg, hd_art,bogf_dato,'
    ||'bogf_dato_char,omreg_Dato,omreg_Dato_char,udsted_valuta,repo_type,'
    ||'kursvaerdi,dkk_kursverdi,HH.DKK_KURTAGE_BELQB,HH.DKK_RTE_BELOEB,'
    ||'hh.dkk_omkostninger,HH.KURSV_TKURS_TILLAEG_BV as fondstermin,' 
    ||'HH.KURSV_VKURS_TILLAEG_BV as valutatermin,''Sladreliste'' as rapport,' 
    ||'bdato.dwday as "Udtræk pr." '
    ||'from supermule.uf_handel_hist hh '
    ||'where trans_Reg_dato = bdato.dwday '
    ||'and ( HH.REPO_TYPE in ( ''REP'' , ''REV'' ) '
	||'or koeb_salg in ( ''I'' , ''U'' )) '
	||'and ( eb_depotnr between 90000 and 99999 '
	||'or kunde_depotnr between 90000 and 99999) '
	||'ORDER BY 18 ASC,19 ASC ';

  l_task:=DBMS_SQLTUNE.CREATE_TUNING_TASK(
                           sql_text => l_sql,
                           user_name => 'SUPERMULE',
                           scope => 'COMPREHENSIVE',
                           time_limit => 3600,
                           task_name => l_task_name,
                           description => '3-9668089711 test');
  dbms_sqltune.Execute_tuning_task (task_name => l_task_name);
  select dbms_sqltune.report_tuning_task(l_task_name) into l_out from dual;
  i0:=dbms_lob.instr(l_out,chr(10),i1);
  loop
    exit when i0=0 or i0 > dbms_lob.getlength(l_out);
    dbms_output.put_line( dbms_lob.substr(l_out, i0-i1, i1 ) );
    i1:=i0+1;
    i0:=dbms_lob.instr(l_out,chr(10),i1);
  end loop;
END;
/

DECLARE
  l_task_name VARCHAR2(30):='G46480_tune_05';
  l_task VARCHAR2(30);
  l_out clob;
  i0 number:=0;
  i1 number:=1;
BEGIN
  l_task_name:='G46480_tune_'||to_char(sysdate,'yyyymmddhh24miss');
  l_task:=DBMS_SQLTUNE.CREATE_TUNING_TASK(
                           begin_snap=>279894,
						   end_snap=>281453, 
						   sql_id => '5ffkc10qw1wm7',
                           scope => 'COMPREHENSIVE',
                           time_limit => 3600,
                           task_name => l_task_name,
                           description => 'dl_pl_tgl');
  dbms_sqltune.Execute_tuning_task (task_name => l_task_name);
  select dbms_sqltune.report_tuning_task(l_task_name) into l_out from dual;
  i0:=dbms_lob.instr(l_out,chr(10),i1);
  loop
    exit when i0=0 or i0 > dbms_lob.getlength(l_out);
    dbms_output.put_line( dbms_lob.substr(l_out, i0-i1, i1 ) );
    i1:=i0+1;
    i0:=dbms_lob.instr(l_out,chr(10),i1);
  end loop;
END;
/


DECLARE
  l_task_name VARCHAR2(30):='G46480_tune_06';
  l_task VARCHAR2(30);
  l_out clob;
  i0 number:=0;
  i1 number:=1;
BEGIN
  l_task_name:='G46480_tune_'||to_char(sysdate,'yyyymmddhh24miss');
  select dbms_sqltune.report_tuning_task(l_task_name) into l_out from dual;
  i0:=dbms_lob.instr(l_out,chr(10),i1);
  loop
    exit when i0=0 or i0 > dbms_lob.getlength(l_out);
    dbms_output.put_line( dbms_lob.substr(l_out, i0-i1, i1 ) );
    i1:=i0+1;
    i0:=dbms_lob.instr(l_out,chr(10),i1);
  end loop;
END;
/
set serveroutput on size 999999
DECLARE
  l_task_name VARCHAR2(30):='G46480_tune_06';
  l_task VARCHAR2(30);
  l_out clob;
  i0 number:=0;
  i1 number:=1;
BEGIN
  l_task_name:='G46480_tune_'||to_char(sysdate,'yyyymmddhh24miss');
  l_task:=DBMS_SQLTUNE.CREATE_TUNING_TASK(
						   sql_id => '1d0sdh31akunh',
                           scope => 'COMPREHENSIVE',
                           time_limit => 3600,
                           task_name => l_task_name,
                           description => 'dl_pl_tgl');
  dbms_sqltune.Execute_tuning_task (task_name => l_task_name);
  select dbms_sqltune.report_tuning_task(l_task_name) into l_out from dual;
  i0:=dbms_lob.instr(l_out,chr(10),i1);
  loop
    exit when i0=0 or i0 > dbms_lob.getlength(l_out);
    dbms_output.put_line( dbms_lob.substr(l_out, i0-i1, i1 ) );
    i1:=i0+1;
    i0:=dbms_lob.instr(l_out,chr(10),i1);
  end loop;
END;
/
31- 


select 'exec sys.nordea_myshrink('''||segment_type||''','''||segment_owner||''','''||segment_name
||''','||decode(partition_name,null,'null',''''||partition_name||'''')||',''Move'');'
from table(dbms_space.asa_recommendations('TRUE', 'FALSE', 'FALSE'))
where (reclaimable_space/allocated_space)>0.5
and segment_type<>'LOB PARTITION'
order by reclaimable_space/allocated_space desc;


-	Citrix link: https://cmz5analytics.dkd1.root4.net/Citrix/XenApp/site/default.aspx
-	User: NEWCITRIX01
-	Password: Wue33shr

select output from table(dbms_workload_repository.awr_report_html(50791047,1,259111,259183,8));

select 'alter table '||owner||'.'||segment_name||' modify partition '||partition_name||' storage(buffer_pool default);' from dba_segments 
where buffer_pool='KEEP' and segment_type in ('TABLE PARTITION') 
and regexp_like (partition_name,'.*_201[4-6]_D[0-1][0-9]_[0-3][0-9]')
and not regexp_like (partition_name,'.*_'||to_char(sysdate-1,'yyyy')||'_D'||to_char(sysdate-1,'MM_DD'));

select distinct 'alter table '||s.owner||'.'||s.segment_name||' modify partition '||p.partition_name||' storage(buffer_pool default) /*'||substr(p.partition_name,length(p.partition_name)-10)||'*/ ;'
from dba_segments s,dba_tab_subpartitions p
where s.buffer_pool='KEEP' and s.segment_type in ('TABLE SUBPARTITION') 
and p.subpartition_name=s.partition_name
 and regexp_like (p.partition_name,'.*_201[4-6]_D[0-1][0-9]_[0-3][0-9]')
 and not regexp_like (p.partition_name,'.*_'||to_char(sysdate-1,'yyyy')||'_D'||to_char(sysdate-1,'MM_DD'))
 and substr(p.partition_name,length(p.partition_name)-10)<to_char(sysdate-1,'yyyy')||'_D'||to_char(sysdate-1,'MM_DD')
;
alter table tgl."BIN$DnphXUy4G6zgVAAQ4C3mFA==$0" storage(buffer_pool default);

select 'alter index '||owner||'.'||segment_name||' modify partition '||partition_name||' storage(buffer_pool default);' from dba_segments 
where buffer_pool='KEEP' and segment_type in ('INDEX PARTITION','INDEX SUBPARTITION') 
and regexp_like (partition_name,'.*_201[4-6]_D[0-1][0-9]_[0-3][0-9]')
and not regexp_like (partition_name,'.*_'||to_char(sysdate-1,'yyyy')||'_D'||to_char(sysdate-1,'MM_DD'));



SELECT a.REPORT_DATE,a.REFERENCE_ENTITY,a.SENIORITY,a.SOURCE,a.RATING_SCALE,a.UNIFORM_RATING_NO,a.UNIFORM_RATING,a.REG_DATE,a.USER_ID FROM CT.CT_REFERENCE_RATING_UNIFORM@BLP a%



remed skal tilføjes 

$scriptDir . "/bin/autospace_inst.sh $Sid/$Dbname
dm11dbadm04 : calypph4
dm12dbadm06 : calyppc6


begin for r in (select sid,serial# from v$session where sql_id='16c4hrry17b5b') loop
begin execute immediate 'alter system disconnect session '''||r.sid||','||r.serial#||''' immediate'; exception when others then null; end;
end loop; end;
/


select first_change#,next_change#,sequence#,thread# from v$archived_log where sequence#=12607 and thread#=3;

select distinct first_change#,next_change#,sequence#,thread#
from v$archived_log where FIRST_CHANGE#> 2543525488988
order by thread#,sequence#;

cma1cs0064.dka1.root4.pri
nd60a620\G46480-Adm

Llandeil0


cd /oracle/stage

export IHRDBMS=/oracle/${ORACLE_SID}/12102
export OHRDBMS=/oracle/${ORACLE_SID}/121
export OHGRID=/oracle/GRID/121
export SBPFUSER=/sbin/fuser



sudo su - root
chown oracle:oinstall /oracle/GRID/121
exit 
unzip -qd $OHGRID/sapbundle SGR12102P_1602-20012313.zip 'SBP_12102160119_201602/OPatch/*'
mv $OHGRID/OPatch $OHGRID/OPatch-pre-SBP_12102160119_201602
mv $OHGRID/sapbundle/SBP_12102160119_201602/OPatch $OHGRID/OPatch
unzip -qd $OHGRID/sapbundle SGR12102P_1602-20012313.zip 'SBP_12102160119_201602/MOPatch/*'
test -d $OHGRID/MOPatch && mv $OHGRID/MOPatch $OHGRID/MOPatch-pre-SBP_12102160119_201602
mv $OHGRID/sapbundle/SBP_12102160119_201602/MOPatch $OHGRID/MOPatch

unzip -qd $IHRDBMS/sapbundle SGR12102P_1602-20012313.zip 'SBP_12102160119_201602/OPatch/*'
mv $IHRDBMS/OPatch $IHRDBMS/OPatch-pre-SBP_12102160119_201602
mv $IHRDBMS/sapbundle/SBP_12102160119_201602/OPatch $IHRDBMS/OPatch
unzip -qd $IHRDBMS/sapbundle SGR12102P_1602-20012313.zip 'SBP_12102160119_201602/MOPatch/*'
test -d $IHRDBMS/MOPatch && mv $IHRDBMS/MOPatch $IHRDBMS/MOPatch-pre-SBP_12102160119_201602
mv $IHRDBMS/sapbundle/SBP_12102160119_201602/MOPatch $IHRDBMS/MOPatch

srvctl add database -d ${ORACLE_SID} -o /oracle/${ORACLE_SID}/121 -p /oracle/${ORACLE_SID}/121/dbs/spfile${ORACLE_SID}.ora -t immediate -r PHYSICAL_STANDBY
export ORACLE_HOME=$OHRDBMS;$OHRDBMS/bin/srvctl stop home -o $OHRDBMS -s $OHRDBMS.srvctlstatus

sudo su - root
fuser /oracle/${ORACLE_SID}/12102/bin/oracle
/oracle/GRID/121/crs/install/roothas.pl -prepatch
exit 

test -d DBBP12102P_1602-20012313 | unzip -qd DBBP12102P_1602-20012313 DBBP12102P_1602-20012313.zip

env ORACLE_HOME=$OHGRID $OHGRID/OPatch/opatch napply -silent -force_conflict -local DBBP12102P_1602-20012313/22243551/22329617
env ORACLE_HOME=$OHGRID $OHGRID/OPatch/opatch napply -silent -force_conflict -local DBBP12102P_1602-20012313/22243551/21948341
env ORACLE_HOME=$OHGRID $OHGRID/OPatch/opatch napply -silent -force_conflict -local DBBP12102P_1602-20012313/22243551/21949015
env ORACLE_HOME=$OHGRID $OHGRID/OPatch/opatch napply -silent -force_conflict -local DBBP12102P_1602-20012313/22243551/21436941

export ORACLE_HOME=$OHGRID;$OHGRID/MOPatch/mopatch.sh -v -s SGR12102P_1602-20012313.zip

sudo su - root
/oracle/GRID/121/rdbms/install/rootadd_rdbms.sh
/oracle/GRID/121/crs/install/roothas.pl -postpatch
test -d /opt/oracle && chmod 755 /opt/oracle
exit

test -d DBBP12102P_1602-20012313 | unzip -qd DBBP12102P_1602-20012313 DBBP12102P_1602-20012313.zip
export ORACLE_HOME=$IHRDBMS;$IHRDBMS/OPatch/opatch napply -silent -force_conflict -local DBBP12102P_1602-20012313/22243551/21949015
export ORACLE_HOME=$IHRDBMS; $IHRDBMS/OPatch/opatch napply -silent -force_conflict -local DBBP12102P_1602-20012313/22243551/22329617

export ORACLE_HOME=$IHRDBMS;$IHRDBMS/MOPatch/mopatch.sh -v -s SGR12102P_1602-20012313.zip

./DBBP12102P_1602-20012313/22243551/22329617/custom/scripts/postpatch.sh -dbhome $IHRDBMS

export ORACLE_HOME=$OHRDBMS;$OHRDBMS/bin/srvctl start home -o $OHRDBMS -s $OHRDBMS.srvctlstatus


export ORACLE_HOME=$OHRDBMS;$OHRDBMS/sapbundle/SBP_12102160119_201602/catsbp

sqlplus / as sysdba 
ALTER SYSTEM SET "_FIX_CONTROL"=
'5099019:ON','5705630:ON','6055658:OFF','6120483:OFF','6399597:ON','6430500:ON',
'6440977:ON','6626018:ON','6972291:ON','7168184:OFF','7658097:ON','8937971:ON',
'9196440:ON','9495669:ON','13077335:ON','13627489:ON','14255600:ON','14595273:ON',
'18405517:2','20355502:8','14846352:OFF'
COMMENT='SAP_12102160119_201602 RECOMMENDED SETTINGS'
SCOPE=SPFILE;

ALTER SYSTEM SET EVENT=
'10027',
'10028',
'10142',
'10183',
'10191',
'10995 level 2',
'38068 level 100',
'38085',
'38087',
'44951 level 1024'
COMMENT='SAP_121022_201503 RECOMMENDED SETTINGS'
SCOPE=SPFILE;

exit 
srvctl stop database -d $ORACLE_SID
srvctl start database -d $ORACLE_SID



2461302

UPDATE TMSDAT.FORMULAS SET CHGTS=sysdate ,RECSEQNO=1 ,FRMLTXT=1  WHERE FORMULAS.FRMLIK = 1  AND FORMULAS.RECSEQNO = 1;
UPDATE TMSDAT.BATCHQUEUE SET SERVERIK=1 ,MSGSTAT=1 ,STARTTIME=sysdate  WHERE BATCHQUEUE.BATCHQUEUEIK = 1  AND BATCHQUEUE.MSGSTAT = 1;
UPDATE TMSDAT.POSRCRUNS SET POSRCSETIK=1,RECONDATE=1,SEGIK=1,FUNDIK=1,PORIK=1,PORGRPIK=1,CALCSEGIK=1,STPLOWSTAT=1,POSRCRUNSTATUS=1,CHGUSR=1,CHGTS=sysdate
WHERE POSRCRUNS.POSRCRUNIK = 1;

UPDATE TMSDAT.FORMULAS SET CHGTS=:v1 ,RECSEQNO=:v2 ,FRMLTXT=:v3  WHERE FORMULAS.FRMLIK = :v4  AND FORMULAS.RECSEQNO = :v5
UPDATE TMSDAT.BATCHQUEUE SET SERVERIK=:v1 ,MSGSTAT=:v2 ,STARTTIME=:v3  WHERE BATCHQUEUE.BATCHQUEUEIK = :v4  AND BATCHQUEUE.MSGSTAT = :v5


SELECT DISTINCT tc.owner, tc.table_name FROM dba_tab_cols tc,
(SELECT name column_name, object_name table_name, owner
FROM dba_objects, sys.col$
WHERE col$.property <> 0 
-- = 1073741824
AND object_id = obj# 
and owner='TMSDAT' and object_name in ('BATCHQUEUE','FORMULAS')) ca
WHERE tc.table_name=ca.table_name AND
tc.column_name=ca.column_name
AND tc.nullable='Y' AND tc.default_length=4 and tc.owner =ca.owner;

Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2461302/nims1p_ora_20381_i2461302.trc


Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2461302/nims1p_ora_20381_i2461302.trc
Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2450182/nims1p_ora_2423_i2450182.trc
Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2452366/nims1p_ora_11355_i2452366.trc
Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2461774/nims1p_ora_1300_i2461774.trc
Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2450166/nims1p_ora_28325_i2450166.trc

		
  

/ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2461302/nims1p_ora_20381_i2461302.trc




Wed Mar 02 15:12:23 2016
Exception [type: SIGSEGV, Address not mapped to object] [ADDR:0x4] [PC:0x10C9CAA64, qcsIsColInFro()+644] [flags: 0x0, count: 1]
Errors in file /ora_diag/diag/rdbms/nims1p/nims1p/trace/nims1p_ora_20381.trc  (incident=2461302):
ORA-07445: exception encountered: core dump [qcsIsColInFro()+644] [SIGSEGV] [ADDR:0x4] [PC:0x10C9CAA64] [Address not mapped to object] []
Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2461302/nims1p_ora_20381_i2461302.trc
Use ADRCI or Support Workbench to package the incident.
See Note 411.1 at My Oracle Support for error and packaging details.
Wed Mar 02 15:15:58 2016
Exception [type: SIGSEGV, Address not mapped to object] [ADDR:0x4] [PC:0x10C9CAA64, qcsIsColInFro()+644] [flags: 0x0, count: 1]
Errors in file /ora_diag/diag/rdbms/nims1p/nims1p/trace/nims1p_ora_2423.trc  (incident=2450182):
ORA-07445: exception encountered: core dump [qcsIsColInFro()+644] [SIGSEGV] [ADDR:0x4] [PC:0x10C9CAA64] [Address not mapped to object] []
Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2450182/nims1p_ora_2423_i2450182.trc
Use ADRCI or Support Workbench to package the incident.
See Note 411.1 at My Oracle Support for error and packaging details.
Wed Mar 02 15:16:06 2016
Dumping diagnostic data in directory=[cdmp_20160302151606], requested by (instance=1, osid=4294969719), summary=[incident=2450182].
Wed Mar 02 15:16:12 2016
Sweep [inc][2461302]: completed
Sweep [inc][2450182]: completed
Sweep [inc2][2450182]: completed
Wed Mar 02 15:17:12 2016
Exception [type: SIGSEGV, Address not mapped to object] [ADDR:0x4] [PC:0x10C9CAA64, qcsIsColInFro()+644] [flags: 0x0, count: 1]
Errors in file /ora_diag/diag/rdbms/nims1p/nims1p/trace/nims1p_ora_11355.trc  (incident=2452366):
ORA-07445: exception encountered: core dump [qcsIsColInFro()+644] [SIGSEGV] [ADDR:0x4] [PC:0x10C9CAA64] [Address not mapped to object] []
Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2452366/nims1p_ora_11355_i2452366.trc
Use ADRCI or Support Workbench to package the incident.
See Note 411.1 at My Oracle Support for error and packaging details.
Wed Mar 02 15:17:20 2016
Dumping diagnostic data in directory=[cdmp_20160302151720], requested by (instance=1, osid=4294978651), summary=[incident=2452366].
Wed Mar 02 15:17:26 2016
Sweep [inc][2452366]: completed
Sweep [inc2][2452366]: completed
Wed Mar 02 15:18:17 2016
Exception [type: SIGSEGV, Address not mapped to object] [ADDR:0x4] [PC:0x10C9CAA64, qcsIsColInFro()+644] [flags: 0x0, count: 1]
Errors in file /ora_diag/diag/rdbms/nims1p/nims1p/trace/nims1p_ora_1300.trc  (incident=2461774):
ORA-07445: exception encountered: core dump [qcsIsColInFro()+644] [SIGSEGV] [ADDR:0x4] [PC:0x10C9CAA64] [Address not mapped to object] []
Incident details in: /ora_diag/diag/rdbms/nims1p/nims1p/incident/incdir_2461774/nims1p_ora_1300_i2461774.trc
Use ADRCI or Support Workbench to package the incident.
See Note 411.1 at My Oracle Support for error and packaging details.
Wed Mar 02 15:18:33 2016

SELECT BUCKETFRMLS.BUCKETFRMLINT,BUCKETFRMLS.BUCKETFRMLEXT FROM TMSDAT.BUCKETFRMLS WHERE (BUCKETFRMLS.BUCKETFRMLINT = 4711 OR BUCKETFRMLS.BUCKETFRMLEXT = 232);

nd60a620\g46480-adm 

nimte_j000_18636.trc
nimte_j000_24131.trc


SQL> begin for r0 in (select sid,serial# from v$session where username='IMPORTAL') loop begin
  2  execute immediate 'alter system disconnect session '''||r0.sid||','||r0.serial#||''' immediate';
  3  exception when others then null; end; end loop; end;
  4  /
set pages 9999 lines 140 trims on long 999999 serveroutput on size 999999
set ver off termout off
col 1 new_value 1
select '' "1" from dual where rownum=0;
def pSid='&1'
col inst_id form 99
set termout on
col sid form 99999
col spid form a6
col username form a16
col serial# form 999999
col event form a32
col module form a32
var cur refcursor

-- prompt e.sql version 0.01
select s.inst_id,s.sid,s.serial#,p.spid,s.sql_id,s.username,nvl(s.action,nvl(s.module,s.program)) module
-- ,decode(s.wait_time,0,s.event,'Active') event,round(decode(s.wait_time,0,s.WAIT_TIME_MICRO/1000000,s.TIME_SINCE_LAST_WAIT_MICRO/1000000)) time
,decode(s.wait_time,0,s.event,'Active') event,round(decode(s.wait_time,0,s.WAIT_TIME_MICRO,s.TIME_SINCE_LAST_WAIT_MICRO)) time
from gv$session s,gv$process p where (s.wait_class<>'Idle' or s.wait_time<>0)
and s.sid not in (select sid from v$mystat where rownum<2)
and s.inst_id=p.inst_id
and s.paddr=p.addr
and s.sid=decode('&pSid','',s.sid,'&pSid')
order by s.username,s.sql_id,s.sid
/
undefine 1
col inst_id form 99
col username form a8
col osuser form a8
col program form a24
col module form a32
col action form a12
col terminal form a16
col event form a32
col row_id form a40

select inst_id,sid,serial#,decode(blocking_session_status,'VALID',blocking_session) blocker
,username /*,osuser,program, */ module /*,action,terminal */ 
/* ,decode(substr(event,1,5),'enq: ',row_wait_obj#||'-'||ROW_WAIT_FILE#||'-'||ROW_WAIT_BLOCK#||'-'||ROW_WAIT_ROW#,'') row_id */
,case when row_wait_obj#<>0 and ROW_WAIT_FILE#<>0 and ROW_WAIT_BLOCK#<>0 then dbms_rowid.rowid_create(1,row_wait_obj#,ROW_WAIT_FILE#,ROW_WAIT_BLOCK#,ROW_WAIT_ROW#)
    ||'('||(select owner||'.'||object_name from dba_objects where data_object_id=row_wait_obj#)||')'
  else '' end row_id
,decode(wait_time,0,event,'Active') event
from gv$session where blocking_session_status='VALID'
or (inst_id,sid) in (select blocking_instance,blocking_session from gv$session where blocking_session_status='VALID')
/



"# non prod
mkdir -p /zfssa/rmantest/backup1/ds001t  
# prod
mkdir -p /zfssa/rmanprod/backup1/cbasop"

cd /me01/oracle/dbadmin/backup
./cr_rman_cat.sh ds001t c

set pages 9999 lines 140 trims on 
col path form a48
select case when regexp_like(substr(path,instr(path,'/',-1)+1),'[20|19][0-9][0-9]_[0-1][0-9]_[0-3][0-9]') then substr(path,1,instr(path,'/',-1)-1) else path end path 
,round(sum(bytes)/1024/1024/1024) gb,max(modification_date) type
from 
(SELECT 
   CONCAT('+' || db_files.disk_group_name, SYS_CONNECT_BY_PATH(db_files.alias_name, '/')) full_path
   ,substr(CONCAT('+' || db_files.disk_group_name, SYS_CONNECT_BY_PATH(db_files.alias_name, '/')),1,instr(CONCAT('+' || db_files.disk_group_name, SYS_CONNECT_BY_PATH(db_files.alias_name, '/')),'/',-1)-1) path
  , db_files.bytes
  , db_files.space
  , db_files.modification_date
  , NVL(LPAD(db_files.type, 18), '<DIRECTORY>')  type
  , db_files.creation_date
  , db_files.disk_group_name
  , LPAD(db_files.system_created, 4) system_created
FROM
    ( SELECT
          g.name               disk_group_name
        , a.parent_index       pindex
        , a.name               alias_name
        , a.reference_index    rindex
        , a.system_created     system_created
        , f.bytes              bytes
        , f.space              space
        , f.type               type
        , TO_CHAR(f.creation_date, 'DD-MON-YYYY HH24:MI:SS')  creation_date
		, f.modification_date  modification_date
      FROM
          v$asm_file f RIGHT OUTER JOIN v$asm_alias     a USING (group_number, file_number)
                                   JOIN v$asm_diskgroup g USING (group_number)
    ) db_files
WHERE db_files.type IS NOT NULL
and disk_group_name like 'S001HHD_RECO%'
START WITH (MOD(db_files.pindex, POWER(2, 24))) = 0
    CONNECT BY PRIOR db_files.rindex = db_files.pindex)
group by case when regexp_like(substr(path,instr(path,'/',-1)+1),'[20|19][0-9][0-9]_[0-1][0-9]_[0-3][0-9]') then substr(path,1,instr(path,'/',-1)-1) else path end,type
order by sum(bytes) desc;


select thread#,min(sequence#) from v$archived_log where first_change#>=(select distinct first_change# from v$archived_log where thread#=1 and sequence#=12908) group by thread#;


select g.name,d.name,d.path from v$asm_disk d,v$asm_diskgroup g where g.group_number=d.group_number order by 1,2;


select databases.sid_name, database_users.username,database_users.password
from sweeper.database_users,sweeper.databases
where database_users.username='RMANPROXY'
and database_users.sid_seq=databases.sid_seq;

select FILENAME,round(bytes/1024/1024/1024) handled
,round(TOTAL_BYTES/1024/1024/1024) total
,round((TOTAL_BYTES-bytes)*100/TOTAL_BYTES) pct
,(sysdate-OPEN_TIME)*24*60*60 elapsed
from gv$backup_async_io where STATUS='IN PROGRESS';


run {
  sql 'alter system set "_backup_disk_bufcnt"=64 scope=memory';
  sql 'alter system set "_backup_disk_bufsz"=1048576 scope=memory';
  sql 'alter system set "_backup_file_bufcnt"=64 scope=memory';
  sql 'alter system set "_backup_file_bufsz"=1048576 scope=memory';

  allocate channel d1 device type disk connect /@rman_fs02ph format '/zfssa/zfs03hh1p/rmanprod/rman10/fs02p1h/%U';
  sql channel d1 "alter session set events ''10466 trace name context forever, level 1''";
  allocate channel d2 device type disk connect /@rman_fs02ph format '/zfssa/zfs03hh1p/rmanprod/rman20/fs02p1h/%U';
  sql channel d2 "alter session set events ''10466 trace name context forever, level 1''";
  backup archivelog all;
}

run {
allocate auxiliary channel aux1 device type disk; 
allocate auxiliary channel aux2 device type disk; 
allocate auxiliary channel aux3 device type disk; 
allocate auxiliary channel aux4 device type disk; 
allocate auxiliary channel aux5 device type disk; 
allocate auxiliary channel aux6 device type disk; 
allocate auxiliary channel aux7 device type disk; 
allocate auxiliary channel aux8 device type disk; 
allocate channel ch1 device type disk; 
allocate channel ch2 device type disk; 
allocate channel ch3 device type disk; 
allocate channel ch4 device type disk; 
allocate channel ch5 device type disk; 
allocate channel ch6 device type disk; 
allocate channel ch7 device type disk; 
allocate channel ch8 device type disk; 
duplicate target database for standby from active database nofilenamecheck;
}


RMAN> run {
2> allocate channel d1 type disk;
3> backup as copy reuse datafilecopy '/u01/app/oracle/product/current/infop_home/dbs/orapwinfo2p' auxiliary format '/tmp/orapwinfo2p';
4> }


conn  sys/d3triton@nimemdh as sysdba 
conn sys/d3triton@nimemdc_dup as sysdba 

nimemdh =
  (description =
    (address = (protocol = tcp)(host = dm13-scan)(port = 1521))
    (connect_data =
      (server = dedicated)
      (service_name = nimemdh)
    )
  )
nimemdc_dup =
  (description =
    (address = (protocol = tcp)(host = dm14db03-vip)(port = 1521))
    (connect_data =
      (server = dedicated)
      (service_name = nimemdc_dgmgrl)
    )
  )



/\/net\/is-nfsorad\/cfs\/is-nfsorad\/ora_export\/scripts\/


/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/links/create_links_dir.sh
/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/alert_monitor/install
/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/backup/install
/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/audit/install_cleanup.sh

/net/js/export/install/media/oracle/scripts/cleanup/install_logcleanup.sh 

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/audit/auditenable.ksh $ORACLE_SID
/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/standby/install $ORACLE_SID not4rose

/net/js/export/install/media/oracle/scripts/autospace/v3/inst.sh $ORACLE_SID/${Dbname}

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/temp_agent/instClient_12.1.0.5.0.sh

P0ntrhydfendigaid



@/net/dkd1mr7913/export/install/media/oracle/scripts/pwdprofile/security_setup.sql


select 'alter user "'||name||'" identified by value '''||nvl(spare4,password)||''';' from user$ where name='ANONYMOUS';

begin
 DBMS_EPG.drop_dad('PATCHING');
 DBMS_EPG.CREATE_DAD('PATCHING', '/patching/*');
 DBMS_EPG.AUTHORIZE_DAD('PATCHING', 'PATCHING');
end;
/


select destination "Standby_dest", 
	extract( day from diff )*24*60*60 +
        extract( hour from diff )*60*60 +
        extract( minute from diff )*60+
	extract( second from diff ) "Sec_behind", 
        diff "Time_behind" from 
(select  destination,
	sysdate-scn_to_timestamp(applied_scn) diff from v$archive_dest_status where (applied_scn is not null and applied_scn>0)); 
	
	
select name, 
	extract( day from diff )*24*60*60 +
        extract( hour from diff )*60*60 +
        extract( minute from diff )*60+
	extract( second from diff ) "Sec_behind", 
        diff "Time_behind" from 
(select name,TO_DSINTERVAL(value) diff,value from v$dataguard_stats where name in ('transport lag','apply lag')); 	

\\NimsTestFS.dka1.root4.pri\NIMS\Nimte\RConnect\Transferred

find ~oracle/dbadmin/ -type f -exec file {} \; |awk '{if($4=="script" && NF>3)print substr($1,1,length($1)-1);}'|egrep -v "(old|spacecheck)"|sort|xargs sum

1. dns check 
2. patch check 
3. os parameters 
4. dba scrips check
5. tnsnames check 
6. database sync 

declare
 l_mail_conn   UTL_SMTP.connection;
BEGIN
  l_mail_conn := UTL_SMTP.open_connection('smtp.oneadr.net',25);
  UTL_SMTP.helo(l_mail_conn, 'smtp.oneadr.net');
  UTL_SMTP.mail(l_mail_conn, 'arne.moller@nordea.com');
  utl_smtp.rcpt(l_mail_conn, 'arne.moller@nordea.com');
  UTL_SMTP.data(l_mail_conn, 'Dette er en lille test'|| ascii(10) ||ascii(13));
  UTL_SMTP.quit(l_mail_conn);
end;
/

select /*+ rule */ distinct 'alter tablespace '||t.name||' end backup;'e from v$tablespace t,v$datafile f,v$backup b
where b.status='ACTIVE'
and b.file#=f.file#
and f.ts#=t.ts#;


select max_utilization, limit_value from gv$resource_limit where inst_id = 1 and resource_name in ('processes','session'); 
java -jar $ORACLE_HOME/jdbc/lib/ojdbc6.jar -getversion
jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS=(PROTOCOL=TCP)(HOST=ora-damdp-a)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-damdp-b)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=damdp)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))
jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS=(PROTOCOL=TCP)(HOST=ora-invn4p-a)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-invn4p-b)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=invn4p)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))

jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS=(PROTOCOL=TCP)(HOST=ora-gpss-a)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=gpss)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))


jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS=(PROTOCOL=TCP)(HOST=db-s001hhd-scan.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=db-s001oed-scan.qaoneadr.local)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=asolvang01s)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))

jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS=(PROTOCOL=TCP)(HOST=db-s002hhd-scan.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=db-s002oed-scan.qaoneadr.local)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=asolvang01s)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))

jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS=(PROTOCOL=TCP)(HOST=db-s002hhd-scan.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=db-s002oed-scan.qaoneadr.local)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=damdp)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))

jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS=(PROTOCOL=TCP)(HOST=ora-gfmt-a.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=ora-gfmt-b.oneadr.net)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=gfmt)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))

-- On original primary:
login as oracle unix user
sqlplus / as sysdba 
select database_role,switchover_status from v$database;
-- must return the following:
--	DATABASE_ROLE    SWITCHOVER_STATUS
--	---------------- --------------------
--	PRIMARY          TO STANDBY

ALTER DATABASE COMMIT TO SWITCHOVER TO PHYSICAL STANDBY WITH SESSION SHUTDOWN;
shutdown immediate 
disconnect 
conn / as sysdba 
STARTUP MOUNT;
-- do not disconnect this session, this session will be resumed when activities on original standby are done 



-- when the orginal primary database has been shut down and started in mount mode then 

-- On original standby:
login as oracle unix user
sqlplus / as sysdba 
select database_role,switchover_status from v$database;
-- must return the following:
--	DATABASE_ROLE    SWITCHOVER_STATUS
--	---------------- --------------------
--	STANDBY          TO PRIMARY
-- It can take some time for the SWITCHOVER_STATUS to go from 'NOT ALLOWED' to 'TO PRIMARY', several minutes

ALTER DATABASE COMMIT TO SWITCHOVER TO PRIMARY WITH SESSION SHUTDOWN;
alter database open;
-- here the virtual ip address ora_remedyp are shutdown on the original primary and started on the original standby
-- and the virtual ip address ora_remedyp_ro are shutdown on the original standby and started on the original primary

~/dbadmin/alert_monitor/keep_alive_v1_0.sh
~/dbadmin/alert_monitor/monitor.sh status

/net/js/Nordea/scripts/db_review.sh -s pingo1s

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/utils/switchover/database_switchover.pl --db <dbname> --syspwd <pwd> --switchover 

-- On original primary: (session resume)
@~/dbadmin/standby/managed_recovery

/clustershare/tools/scripts/dbadmin/oh_check/oh_in_use.sh 
https://wiki.itgit.oneadr.net/display/ORA/Decommissioning+Oracle+Home+on+Exadata 


--- autospace fix up group info ---- Retrospective Incident Management
select 'update DBADMIN.AUTOSPACE_TABLESPACES_T set group_name='''||substr(file_name,19,6)||
''' where tablespace_name='''||tablespace_name||''';' from dba_data_files
where file_id in (select min(file_id) from dba_data_files group by tablespace_name)
and substr(file_name,19,5)='group';
select 'update DBADMIN.AUTOSPACE_DIRECTORIES set group_name='''||substr(directory_name,19,6)||
''' where directory_name='''||directory_name||''';'  from DBADMIN.AUTOSPACE_DIRECTORIES 
where substr(directory_name,19,5)='group';



mkdir -p /me01/arne
useradd -c "Arne Moeller, for testing Oracle client" -G users -u 2001 -d /me01/arne arne  
chown arne:users /me01/arne
passwd arne 



Is the local system ready for patching? [y|n]
y
User Responded with: Y
Backing up files...
Applying interim patch '26609817' to OH '/u01/app/oracle/product/12.2.0.1/client_1'
ApplySession: Optional component(s) [ oracle.ctx, 12.2.0.1.0 ] , [ oracle.rdbms, 12.2.0.1.0 ] , [ oracle.tfa, 12.2.0.1.0 ]  not present in the Oracle Home or a higher version is found.

Patching component oracle.oracore.rsf, 12.2.0.1.0...
Patching component oracle.rdbms.deconfig, 12.2.0.1.0...
Patching component oracle.rdbms.rsf, 12.2.0.1.0...
Patching component oracle.rdbms.rman, 12.2.0.1.0...
Patching component oracle.rdbms.util, 12.2.0.1.0...
Patching component oracle.rdbms.dbscripts, 12.2.0.1.0...
Patching component oracle.rdbms.rsf.ic, 12.2.0.1.0...
Make failed to invoke "/usr/bin/make -f ins_rdbms.mk ikfed ORACLE_HOME=/u01/app/oracle/product/12.2.0.1/client_1"....'/usr/bin/ld: /u01/app/oracle/product/12.2.0.1/client_1/rdbms/lib/sskfeded.o: No such file: No such file or directory
make: *** [/u01/app/oracle/product/12.2.0.1/client_1/rdbms/lib/kfed] Error 1
'
The following make actions have failed :
Re-link fails on target "ikfed".
Patch 26609817 successfully applied.
OPatch Session completed with warnings.
Log file location: /u01/app/oracle/product/12.2.0.1/client_1/cfgtoollogs/opatch/opatch2017-10-11_16-24-19PM_1.log
OPatch completed with warnings.



RMAN-05001: auxiliary file name /ora_redo02B_infop/redolog/redo23a.log conflicts with a file used by the target database
RMAN-05001: auxiliary file name /ora_redo02A_infop/redolog/redo23b.log conflicts with a file used by the target database
RMAN-05001: auxiliary file name /ora_redo01A_infop/redolog/redo22a.log conflicts with a file used by the target database
RMAN-05001: auxiliary file name /ora_redo01B_infop/redolog/redo22b.log conflicts with a file used by the target database
RMAN-05001: auxiliary file name /ora_redo02A_infop/redolog/redo21b.log conflicts with a file used by the target database
RMAN-05001: auxiliary file name /ora_redo02B_infop/redolog/redo21a.log conflicts with a file used by the target database
RMAN-05001: auxiliary file name /ora_redo01B_infop/redolog/redo20a.log conflicts with a file used by the target database
RMAN-05001: auxiliary file name /ora_redo01A_infop/redolog/redo20b.log conflicts with a file used by the target database

ohs=""
for db in $(srvctl config database) ; do  
  srvctl config database -d $db|while read line ; do 
    if [[ "$oh" == "$z" ]] ; then 
      if [[ "$line" =~ (^Oracle home) ]] ; then 
        oh=$(echo $line|grep "^Oracle home: "|awk '{print $3}')
        echo "$oh "
      fi 
      if [[ "$line" =~ ^PRCD-1229  ]] ; then 
        oh=$(echo $line|grep "^PRCD-1229 "|awk '{print substr($28,1,length($28)-1)}')
        echo "$oh "
      fi 
	fi
  done 
done|sort -u




#!/bin/bash
# set -x on
inst=$(grep \+ASM /etc/oratab|awk -F: '{print $1}')
export PATH=$PATH:/usr/local/bin
export ORAENV_ASK=NO
export ORACLE_SID=$inst
export ORATAB=/etc/oratab
. oraenv </dev/null >/dev/null
oracle_home_i0=0

dirs=$(for db in $(srvctl config database) ; do  
  oh=""
  srvctl config database -d $db|while read line ; do 
    if [[ "$oh" == "$z" ]] ; then 
      if [[ "$line" =~ (^Oracle home) ]] ; then 
        oh=$(echo $line|grep "^Oracle home: "|awk '{print $3}')
        echo "$oh"
      fi 
      if [[ "$line" =~ ^PRCD-1229  ]] ; then 
        oh=$(echo $line|grep "^PRCD-1229 "|awk '{print substr($28,1,length($28)-1)}')
        echo "$oh"
      fi 
	fi
  done 
done|sort -u)
for d in $dirs ; do
oracle_home[$oracle_home_i0]=$d
oracle_home_i0=$(($oracle_home_i0 + 1))
echo "<$d>"
done
homes="nottofound"
nuohi=0
for l in $(ls -d1 /u01/app/oracle/product/*/db*|sort) ; do
  i1=0
  found=0
  while [[ $i1 -lt $oracle_home_i0 && $found -eq 0 ]] ; do
    if [[ $l == ${oracle_home[$i1]} ]] ; then
      found=1
    fi
    i1=$(($i1 + 1))
  done
  if [[ $found -eq 0 ]] ; then
    echo "<$l> is not referenced in srvctl"
    nuoh[$nuohi]=$l
    nuohi=$(($nuohi + 1))
    homes="$homes|$l"
  fi
done

egrep -v "\-MGMTDB|\+ASM|^#|~ *$" $ORATAB|while read l ; do
  db=$(echo $l|awk -F: '{print $1}')
  oh1=$(echo $l|awk -F: '{print $2}')
  found=0
  i1=0
  while [[ $i1 -lt $nuohi &&  $found -eq 0 ]] ; do
    if [[ $oh1 == ${nuoh[$i1]} ]] ; then
      found=1;
    fi
    i1=$(($i1 + 1))
  done
  if [[ $found -eq 1 ]] ; then
    processes=$(ps -ef|grep ora_smo[n]_$db|wc -l)
    if [[ $processes -gt 0 ]] ; then
      export ORACLE_HOME=$oh1
      oh2=$($oh1/bin/srvctl config database -d $db|grep "^Oracle home:" |awk '{print $3}')
      running="  running on $oh2";
    else
      running="";
    fi
    echo "Oratab $db refere til $oh1${running}"
  fi
done
echo "-- lines found in dbfs scripts --"
egrep $homes /u01/app/12*/grid/crs/script/*
echo "-- Following lines found in listener.ora that contains unused databases --"
egrep $homes $ORACLE_HOME/network/admin/listener.ora

 CONVERT="/ora_redo01A_infop/,/ora_redo01A_infot/,/ora_redo01B_infop/,/ora_redo01B_infot/,/ora_redo02A_infop/,/ora_redo02A_infot/,/ora_redo02B_infop/,/ora_redo02B_infot/,";
 
 
sos1exadata/
sos1Exadata

henrik saari

10035

connect target sys/p3triton@infop
connect auxiliary sys/p3triton@info31d
connect catalog infop/cat_infop@rmanp
run{
allocate auxiliary channel a1 type 'SBT_TAPE' PARMS='ENV=(TDPO_OPTFILE=/opt/tivoli/tsm/client/oracle/bin64/tdpo_infop_cb.opt)';
setlimit channel a1 kbytes 20971520;
allocate auxiliary channel a2 type 'SBT_TAPE' PARMS='ENV=(TDPO_OPTFILE=/opt/tivoli/tsm/client/oracle/bin64/tdpo_infop_cb.opt)';
setlimit channel a2 kbytes 20971520;
allocate auxiliary channel a5 type 'SBT_TAPE' PARMS='ENV=(TDPO_OPTFILE=/opt/tivoli/tsm/client/oracle/bin64/tdpo_infop_hh.opt)';
setlimit channel a5 kbytes 20971520;
allocate auxiliary channel a6 type 'SBT_TAPE' PARMS='ENV=(TDPO_OPTFILE=/opt/tivoli/tsm/client/oracle/bin64/tdpo_infop_hh.opt)';
setlimit channel a6 kbytes 20971520;
allocate auxiliary channel a9 type 'SBT_TAPE' PARMS='ENV=(TDPO_OPTFILE=/opt/tivoli/tsm/client/oracle/bin64/tdpo_infop.opt)';
setlimit channel a9 kbytes 20971520;
allocate auxiliary channel a10 type 'SBT_TAPE' PARMS='ENV=(TDPO_OPTFILE=/opt/tivoli/tsm/client/oracle/bin64/tdpo_infop.opt)';
setlimit channel a10 kbytes 20971520;
   set until time  "to_date('NOV 30 2017 10:00:00', 'MON DD YYYY HH24:MI:SS')";
   recover½
   clone database
    delete archivelog
   ;
}

select 'alter user '||username||' profile '||profile||';' from dba_users where username='G46480';
create profile c##g46480_profile limit PASSWORD_REUSE_TIME unlimited PASSWORD_VERIFY_FUNCTION null PASSWORD_REUSE_MAX unlimited;
alter user G46480 profile c##g46480_profile;
alter user G46480 identified by hyt765TE account unlock;
-- exec stmt fra linie 1 
drop profile c##g46480_profile;

select 'alter user '||username||' profile '||profile||';' from dba_users where username='SYSBACKUP';
create profile c##g46480_profile limit PASSWORD_REUSE_TIME unlimited PASSWORD_VERIFY_FUNCTION null PASSWORD_REUSE_MAX unlimited;
alter user SYSBACKUP profile c##g46480_profile;
alter user SYSBACKUP identified by Tapa2last4ever account unlock;
-- exec stmt fra linie 1 
drop profile c##g46480_profile;


SQL> spool renfiles.sql
SQL> set pages 0 lines 255 trims on heading off
SQL> select 'alter database rename file '''||name||''' to '''||replace(file,'/infop/','/info3d/')||''';'
  2  from v$datafile where name<>replace(file,'/infop/','/info3d/');
'FYWAY_RELEASE','OTC_INFO','OTCBATCH','CSA','TGL','INTERFACES','EQTRD','SA','CCP_INFO','


select table_owner,count(*) from dba_tab_modifications
where not regexp_like(table_owner,'[GD][0-9][0-9][0-9][0-9]*')
and table_owner not in ('SYS','SYSTEM','OUTLN','XMLDB','BL','XDB','GGSMGR','DBADMIN','EXFSYS','TOAD','DBA_AUD','DLCM_AGENT','DBSNMP')
group by table_owner

1. oracle installation db-nfirpt1p
2. decommision db-abacus1p,db-mdm1p
3. Database not started (database not started by srvctl) db-abacus1p

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/parallel/go_parallel.sh -n 20 /net/is-nfsorad/cfs/is-nfsorad/ora_export/g46480/bin/chkdb hosts
screen -R 

date; asmcmd iostat -t -G DATA --io 2;date 
iostat -d -x -p sdc,sde 2|awk '{print strftime("%Y%m%d-%H%M%S"), $0}' 


nddbctl distribute passwordfile --databaseUniqueName cbaobt1c



 # User should use 
 $OWB_HOME/rtasst/wb_rt_reset_location.pls
 $OWB_HOME/rtasst/wb_rt_reset_location.plb

 
col sid form a20
col name form a32
col value form a64
select sid,name,value from v$spparameter where name='undo_tablespace' order by name,sid


    FROM transaction_record_stat trs
    JOIN

FROM TRANSACTION_RECORD_HIST trh
          ORDER BY trh.id_transaction_record_stat desc, trh.record_timestamp desc
      ) trh
    ON trs.id               = trh.id_transaction_record_stat
    WHERE trh.last_record   = 1
	
select count(*),count(distinct last_record) last_record,sum(decode(last_record,null,1,0)) last_record_n
,count(distinct id_transaction_record_stat) id_transaction_record_stat,sum(decode(id_transaction_record_stat,null,1,0)) id_transaction_record_stat_n
from GAI2_REC_PROD.transaction_record_stat;


"-oracle_base=s"=>\$ORACLE_BASE,"-sid=s"=>\$Sid
      ,"-dbname=s"=>\$Dbname,"-cleanup!"=>\$Cleanup,"-upgrade!"=>\$Upgrade,"-inventory=s"=>\$oraInventory
      ,"-ASM_HOME=s"=>\$P_ASM_HOME,"-ORACLE_HOME=s"=>\$P_ORACLE_HOME
      ,"-log_file=s"=>\$log_file,"-debug_level=s"=>\$debug_level,"-silent_mode=s"=>\$silent_mode)
./01_cleanup.pl	--oracle_base=/u01/app/oracle --sid=marius2s --dbname=mariuss --cleanup --inventory=/u01/app/oracle/globalInventory --ASM_HOME=/u01/app/oracle/product/11.2.0.4/cw180417a --ORACLE_HOME=/u01/app/oracle/product/11.2.0.4/db180417a -log_file=/tmp/uninstall.log --debug_level=DEBUG --silent_mode=n

DECLARE
  P_METRIC_NO NUMBER;
  P_METRIC_RESULT NUMBER;
BEGIN
  P_METRIC_NO := 20;
  NIMS_MONITOR.MONITOR.MONITOR(
    P_METRIC_NO => P_METRIC_NO,
    P_METRIC_RESULT => P_METRIC_RESULT
  );
END;
/ .

egrep "maintenance|production" ~/dbadmin/alert_monitor/alert_monitor.cfg


https://collab-vpn.oneadr.net/sites/oracle-database/SME/_layouts/15/xlviewer.aspx?id=/sites/oracle-database/SME/Standard%20Operating%20Procedures%20Database/SYS%20and%20SYSTEM%20Keywords.xlsx&DefaultItemOpen=1


1) disable DG configuration på primær
-- dgmgrl / disable configuration;

2)
på Standby: 
kun 1 node tændt.
mount mode
flashback database
Alter database open read only;
Start de ekstra noder som var oppe før.

3) På Primær
kun 1 node tændt
Mount mode
flashback database
alter database open resetlogs;
start de ekstra noder som var oppe før.
enable DG configuration (dgmgrl / enable configuration;)
show configuration (dgmgrl)
hvis den skriver: (primary has diverged from standby (eller omvendt) - Vente lidt et par minutter)
- Hvis den fortsætter som diverged, genstart standby. srvctl stop/start


Sand2last4ever
Dune2last4ever
Tend2last4ever
Soon2last4ever!

Town2last4ever
Down2last4ever

select 'alter '||decode(owner,'PUBLIC','public ','')||case when object_type like '%BODY' then substr(object_type,1,length(object_type)-5) else object_type end
  ||' "'||owner||'"."'||object_name||'" compile'||case when object_type like '%BODY' then ' body' else '' end||';' 
from dba_objects where status<>'VALID' 
-- and owner in ('NIMS_EXT','NIMS_READ') 
order by decode(object_type,'TABLE',0,'MATERIALIZED VIEW',2,'VIEW',3,'PROCEDURE',4,'FUNCTION',5,'PACKAGE',6,'TRIGGER',7,99);


select object_type,owner,object_name 
from dba_objects where status<>'VALID' 
-- and owner in ('NIMS_EXT','NIMS_READ') 
order by object_type,owner,object_name ;


alter table t1 modify lob(t1_clob) (allocate extent (size 16m instance 1));

'BEGIN execute immediate ''alter system set log_archive_trace=4095''; END;'
'15-JUL-08 1.00.00AM US/Pacific'
'15-SEP-08 1.00.00AM US/Pacific'

BEGIN
DBMS_SCHEDULER.CREATE_JOB(job_name=>'sys.log_archive_trace_start',job_type=>'PLSQL_BLOCK'
,job_action=>'BEGIN execute immediate ''alter system set log_archive_trace=4095''; END;'
,start_date=>to_date('20180919 003000','yyyymmddhh24miss'),repeat_interval=>'FREQ=DAILY'
,end_date=>to_date('20180923 013000','yyyymmddhh24miss')
,enabled=>TRUE,comments=>'Set log_archive_trace=4095');
END;
/

BEGIN
DBMS_SCHEDULER.CREATE_JOB(job_name=>'sys.log_archive_trace_end',job_type=>'PLSQL_BLOCK'
,job_action=>'BEGIN execute immediate ''alter system set log_archive_trace=0''; END;'
,start_date=>to_date('20180919 033000','yyyymmddhh24miss'),repeat_interval=>'FREQ=DAILY'
,end_date=>to_date('20180923 043000','yyyymmddhh24miss')
,enabled=>TRUE,comments=>'Set log_archive_trace=4095');
END;
/



availability -> "high availability console" 
./create_new_rac_oracle_home_from_clone_file.sh -newOracleHome /u01/app/oracle/product/12.1.0.2/db171017g -inputTarGZFile /patchtmp/12102_db171017f.tar.gz

1. extract tablespaces 

2. extract database_links 
3. extract users 


DK 44 808 100) ID 6483095 PW 112233

377



BUG 27255377 - ORA-00600: INTERNAL ERROR CODE, ARGUMENTS: [KTEUPROPAGATETIME:CLSVIOL_KCBGCUR_9]Sev 1 SR (supersedes Bug#26516536 ) 
BUG 27367194 - MISSING STACK VARIABLE INIT LEADING TO LOB SEGMENT GROWTH 
BUG 27255377 - ORA-00600: INTERNAL ERROR CODE, ARGUMENTS: [KTEUPROPAGATETIME:CLSVIOL_KCBGCUR_9]Sev 1 SR (supersedes Bug#26516536 ) 
BUG 27367194 - MISSING STACK VARIABLE INIT LEADING TO LOB SEGMENT GROWTH 

declare 
l_instance varchar2(32); 
procedure execsql(p_sql in varchar2) is 
dbms_output('executing '||p_sql);
end execsql; 
begin 
select instance_name into l_instance from v$instance;
if l_instance='nimsp2h3' then 
for r0 in (select tablespace_name from dba_tablespaces where tablespace_name not in
(select tablespace_name from dba_segments where segment_name='NORDEA_AUDIT_HISTORY' and owner='DBADMIN')
and contents='PERMANENT'
and tablespace_name not in ('SYSTEM','SYSAUX','NORDEA_AUDIT')) loop 
execsql('drop tablespace '||tablespace_name||' including contents and datafiles');
end loop; 
end; 
/	 

2018-08-31 10:20:22.086
2018-08-31 20:37:23.043


*** trace ***
alter system set events 'sql_trace[SQL: 82nyjnhmwuxkf] plan_stat=all_executions,wait=true,bind=true';   
alter system set events 'sql_trace[SQL: **SQL_ID** ] plan_stat=all_executions,wait=true,bind=true';   
http://tech.e2sn.com/oracle/troubleshooting/oradebug-doc  

alter system set events 'sql_trace off';


20:27 - 21:55
select * from (
select thread#,sequence#,round((blocks*block_size)/1024/1024) mb,(next_time-first_time)*60*60*24 elaps,first_time,next_time
,round((blocks*block_size)/(greatest(next_time-first_time,1)*60*60*24)/1024/1024) "mb/s" 
from v$archived_log
where dest_id=1  order by (blocks*block_size)/(greatest((next_time-first_time),1)*60*60*24) desc)
where rownum<11;

nddbctl
nddbctl create database \
--oracleHome /u01/app/oracle/product/12.1.0.2/db171017f \
--nlsLengthSemantics char \
--databaseType tiny \
--databaseUniqueName nimsp9c \
--characterSet AL32UTF8 \
--nationalCharacterSet AL16UTF16 \
--runOnNodes dm22db03,dm22db04 \
--prepareAsStandby \
--primaryScanListener dm22-scan.oneadr.net \
--primaryDatabaseUniqueName nimsp1c

ndtnsctl addorupdate tnsconf --entries remote --remoteDatabaseUniqueName infot --remoteScanListener ora_infot.oneadr.net
ndtnsctl addorupdate tnsconf --entries remote --remoteDatabaseUniqueName csgpt --remoteScanListener ora_csgpt.oneadr.net
ndtnsctl addorupdate tnsconf --entries remote --remoteDatabaseUniqueName martit --remoteScanListener ora-martit-a.qaoneadr.local
ndtnsctl remove tnsconf --entries local --remoteDatabaseUniqueName dlcmp


ndtnsctl remove tnsconf --entries all --databaseUniqueName GRID_50OI_T --remoteDatabaseUniqueName GRID_50OI_T --remoteScanListener db-s001hhd-scan.oneadr.net --remoteNodeVip dm13db03-vip.oneadr.net 
ndtnsctl remove tnsconf --entries all --databaseUniqueName gpst --remoteDatabaseUniqueName gpst --remoteScanListener db-s001hhd-scan.oneadr.net
conn g46480[STDBYPERF]/pol098iK
@?/rdbms/admin/sbreport

ndclonectl 


select s.inst_id inst,s.sid,s.serial# ser,s.sql_id,s.username,decode(s.wait_time,0,s.event,'Active') event
,decode(s.wait_time,0,s.seconds_in_wait,0) time
 from gv$session s,gv$process p where (s.wait_class<>'Idle' or s.wait_time<>0) and s.status='ACTIVE'
 and (s.sql_id) not in (select sql_id from v$session where sid=(select distinct mi.sid from v$mystat mi))
 and s.paddr=p.addr and s.inst_id=p.inst_id
 order by s.username,s.sql_id,s.sid;
question 

Arnes plan 
Efter 
1. validate constraints 
ALTER TABLE TMSDAT.PRICESRCH enable validate CONSTRAINT C_PRICESRCH_HASHVAL;
ALTER TABLE TMSDAT.PRICESRCH enable validate CONSTRAINT C_PRICESRCH_PRICESRCHIK;
2. init dataguard 

3. start backup 


ALTER TABLE TMSDAT.PRICESRCH enable novalidate CONSTRAINT C_PRICESRCH_HASHVAL;
ALTER TABLE TMSDAT.PRICESRCH enable novalidate CONSTRAINT C_PRICESRCH_PRICESRCHIK;


select CLIENT_NAME,STATUS from DBA_AUTOTASK_OPERATION;
BEGIN
  DBMS_AUTO_TASK_ADMIN.disable(client_name=>'auto optimizer stats collection',operation=>NULL,window_name=>NULL);
  DBMS_AUTO_TASK_ADMIN.disable(client_name=>'auto space advisor',operation=>NULL,window_name=>NULL);
  DBMS_AUTO_TASK_ADMIN.disable(client_name=>'sql tuning advisor',operation=>NULL,window_name=>NULL);
END;
/

ALTER PLUGGABLE DATABASE STORAGE UNLIMITED;

select sql_id,disk_reads,executions,rows_processed from 
(select * from v$sqlarea 
where sql_id in (select distinct sql_id from V$SQL_PLAN where object_name='ERRORLOG' and object_owner='TMSDAT')
order by disk_reads desc)
where rownum<26;

select * from 
(select sql_id,sum(disk_reads) disk_reads,sum(executions) executions,sum(rows_processed) rows_processed 
from gv$sqlarea 
where sql_id in (select distinct sql_id from gV$SQL_PLAN where object_name='SCTRD' and object_owner='OM3_ARC_EXECUTIONS')
group by sql_id
order by disk_reads desc)
where rownum<26
order by disk_reads desc;


select * from sweeper.database_database;
select u.username,u.password,d.name,u.*,d.* 
from sweeper.database_users u,sweeper.database_database d 
where d.sid_seq=u.sid_seq
and username='WSSREAD' and u.password is not null;
Gpsbatchp&18nov 

ap-batch1p-a: gpsbatch/Gpsbatchp&19jan 



Defunc processes
ps -elf | grep oracle | awk '$2 == "D"' | wc -l

https://lync.nordea.com/02/incident.management.team/SBTYN11G

select inst_id,username,count(*) from gv$session group by inst_id,username order by inst_id,username;

Rebuild sop: 
select PROPERTY_NAME||'='||PROPERTY_VALUE from database_properties where property_name in ('NLS_CHARACTERSET','NLS_NCHAR_CHARACTERSET','NLS_LENGTH_SEMANTICS');
nddbctl delete services --databaseUniqueName h5075p1o --pdbName P_UC4_UC40_20092209_P
 
nddbctl delete pdb --databaseUniqueName h5075p1o --pdbName P_UC4_UC40_20092209_P


nddbctl delete services --databaseUniqueName h5075p1h --pdbName P_UC4_UC40_20092209_P
 
nddbctl delete pdb --databaseUniqueName h5075p1h --pdbName P_UC4_UC40_20092209_P


nddbctl create pdb \
--pdbFriendlyName uc4p \
--pdbApplicationCode uc40 \
--databaseUniqueName h5075p1h \
--useSGAMemory 16gb \
--useCpuCount 2 \
--useStorageCapacity 20tb \
--useStorageIops 40000iops \
--useStorageBandwidth 1gbps \
--useNodes 1 \
--nlsLengthSemantics char \
--pdbPlugFile /clustershare/pdb_seeds/seed_we8iso8859p1_122010.pdb 


Procedure til Rebuild Standby på SOP:

https://nordea.sharepoint.com/sites/oracle-database/SME/Standard%20Operating%20Procedures%20Database/Forms/Category.aspx?q=rebuild&id=%2Fsites%2Foracle%2Ddatabase%2FSME%2FStandard%20Operating%20Procedures%20Database%2FRebuild%20standby%20database%20on%20SOP%2Etxt&parent=%2Fsites%2Foracle%2Ddatabase%2FSME%2FStandard%20Operating%20Procedures%20Database&parentview=7 

nddbctl dgfinish pdb --pdbName P_CSGP_CSSW_20040111_P --databaseUniqueName h5107p1h

Ilija


select count(*) from CCDC.PCS_PARTY_CLASS;

SELECT
   ROWID, Q_NAME, MSGID, CORRID,
   PRIORITY, STATE, DELAY,
   EXPIRATION, TIME_MANAGER_INFO, LOCAL_ORDER_NO,
   CHAIN_NO, CSCN, DSCN,
   ENQ_TIME, ENQ_UID, ENQ_TID,
   DEQ_TIME,DEQ_UID, DEQ_TID,
   RETRY_COUNT, EXCEPTION_QSCHEMA, EXCEPTION_QUEUE,
   STEP_NO, RECIPIENT_KEY, DEQUEUE_MSGID,
   SENDER_NAME, SENDER_ADDRESS, SENDER_PROTOCOL,
   USER_DATA
FROM BL.CCDC_CLASS_CRE_IN_TABLE
ORDER BY 14 DESC NULLS LAST


select deq_time,enq_time,q_name,state from CCDEDG_LEI_OUT_TABLE where q_name!='AQ$_CCDEDG_LEI_OUT_TABLE_E';

select count(*) from sys.AQ_SRVNTFN_TABLE_1 --where state=0;
select a.reg_id,b.subscription_name,b.location_name,a.num_ntfns,a.num_pending_ntfns
from gV$SUBSCR_REGISTRATION_STATS a, DBA_SUBSCR_REGISTRATIONS b where a.reg_id=b.reg_id;

BEGIN
  DBMS_AUTO_TASK_ADMIN.disable(
    client_name => 'sql tuning advisor',
    operation   => NULL,
    window_name => NULL);
END;
/
status of autotask: 
select CLIENT_NAME,STATUS from DBA_AUTOTASK_OPERATION;

Last execution status:
select CLIENT_NAME,LAST_TRY_RESULT from DBA_AUTOTASK_TASK; 



--on Standby (CDB)
set serveroutput on
DECLARE
  P_PROFILE VARCHAR2(200);
BEGIN
  P_PROFILE := 'cpu_8';
  c##nordeasystem.PROFILE.SET_CDB_STD_PROFILE( P_PROFILE => P_PROFILE );
END;
/


memory_32_gb
cpu_8
--on Primary (CDB)
set serveroutput on
DECLARE
  P_PROFILE VARCHAR2(200);
BEGIN
  P_PROFILE := 'memory_32_gb';
  c##nordeasystem.PROFILE.SET_CDB_STD_PROFILE( P_PROFILE => P_PROFILE );
END;
/

--on Primary (PDB)
DECLARE
  P_PROFILE VARCHAR2(200);
  P_PDBNAME VARCHAR2(128);
BEGIN
  P_PDBNAME := 'P_UC4_UC40_20091614_D';
  P_PROFILE := 'memory_32_gb';
  c##nordeasystem.PROFILE.SET_PDB_PROFILE( p_pdb_name => P_PDBNAME, P_PROFILE => P_PROFILE );
END;
/

conn system/Deep2last4ever@(DESCRIPTION=(LOAD_BALANCE=OFF)(FAILOVER=ON)(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=db-s002hhd-scan.qaoneadr.local)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=db-s002oed-scan.qaoneadr.local)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=monitd)(FAILOVER_MODE=(TYPE=SELECT)(METHOD=BASIC))))


srvctl stop service -database gpeipp1c -service gpeipp_ro;srvctl remove service -database gpeipp1c -service gpeipp_ro;srvctl add service -database gpeipp1c -service gpeipp_ro  -preferred gpeipp1c7 -available gpeipp1c1,gpeipp1c2,gpeipp1c3,gpeipp1c4,gpeipp1c5,gpeipp1c6,gpeipp1c8 -role PHYSICAL_STANDBY;srvctl start service -database gpeipp1c -service gpeipp_ro
srvctl remove service -database gpeipp1h -service gpeipp_ro;srvctl add service -database gpeipp1h -service gpeipp_ro  -preferred gpeipp1h7 -available gpeipp1h1,gpeipp1h2,gpeipp1h3,gpeipp1h4,gpeipp1h5,gpeipp1h6,gpeipp1h8 -role PHYSICAL_STANDBY


set pages 9999 lines 140 trims on 
col a form a140 
select distinct ',"'||bp.handle||'"' a from v$backup_piece bp,v$backup_datafile bf
where bf.checkpoint_time is null
and bp.set_stamp=bf.set_stamp;
-- and bp.stamp=bf.stamp

insert into DISK_BACKUP_PATHS values('gpeth','Y','/zfssa/rmantest/backup1/gpet'); 
insert into DISK_BACKUP_PATHS values('gpert1c','Y','/zfssa/zfs03cb1p/rmannonprod/rman20/gpert1c'); 

insert into DISK_BACKUP_PATHS values('gperth','Y','/zfssa/rmantest/backup1/gpert/'); 



compute(nordea) -> vdc unix 

-- host affected by db migrate
select distinct h.host_name
from nodbot.dblinks l,nodbot.databases d,nodbot.hosts h
where lower(l.host) like '%mccd%' 
and l.db_id=d.db_id 
and d.usage_status in ('In use','To be decomm','Archived') 
and db_name not like '%P'
and d.host_id=h.host_id
order by h.host_name;


cluster restart 
crsctl stop res ora.crsd -init
crsctl start res ora.crsd -init


      "alter session set current_schema = SYSMAN;"
select 'OK:'||t.target_name||':'||target_guid||':'|| 
      (select status 
         from SYSMAN.GC$BLACKOUT_TARGETS b 
        where t.target_guid = b.target_guid  and rownum = 1) status 
   from mgmt$target t 
 where t.target_type in ( 'rac_database' , 'oracle_database' )
   and lower(t.target_name) = '${TARGET_NAME,,}';


select distinct t.target_name,b.status from sysman.gc$blackout_targets b, sysman.mgmt$target t
where t.target_type in ( 'rac_database' , 'oracle_database' )
and t.target_guid=b.target_guid
and lower(t.target_name) in ('cbpad1c','cbpad1h','cbpbt1c','cbpct1h','cbpdas1h','cbpdhs1c','cbpdls1h','cbpdrs1c','cbpgt1c','cbpit1h','ds008d1h','gpeiadh','gpeiat1h','gpeipd1c','gpeipd1h','gpert1c','gperth','gpetc','h0031d1h','h0042d1h','h0044d1h','h0052d1o','h0068d1h','h0137d1h','nobidh','s0093t1h')
and b.status not in ('Ended','Scheduled')
-- and t.target_name not like '%\_%' escape '\'
/


exec dbms_java.grant_permission('MCC','java.io.FilePermission','/dbfs/tccm/mccd/mcc/log/','read');
exec dbms_java.grant_permission('MCC','java.io.FilePermission','/dbfs/tccm/mccd/mcc/ftp_in/','read');

#!/bin/bash
set -
cmd=$0
db=reme3d
script=$(echo $cmd|awk -F/ '{print $NF}'|awk -F. '{print $1}')
export PATH=$PATH:/usr/local/bin
export ORAENV_ASK=NO
export ORACLE_SID=$db
. oraenv </dev/null
tstmp=$(date +%Y%m%d%H%M%S)
logname="${script}_${tstmp}.log"
rman <<__eof__ >>${logname}
connect target sys/d3triton@(DESCRIPTION=(LOAD_BALANCE=on)(FAILOVER=Off)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=db-remed-hh-rep.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=db-remed-hh.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=db-remed-hh2-bck.oneadr.net)(PORT=1521)))(CONNECT_DATA=(sid=reme1d)(ur=a)))
connect auxiliary sys/d3triton@(DESCRIPTION=(LOAD_BALANCE=on)(FAILOVER=Off)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=db-remed-oe-rep.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=db-remed-oe.oneadr.net)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=db-remed-oe1-bck.oneadr.net)(PORT=1521)))(CONNECT_DATA=(sid=reme3d)(ur=a)))
run {
ALLOCATE auxiliary CHANNEL aux1 DEVICE TYPE DISK;
ALLOCATE AUXILIARY CHANNEL aux2 DEVICE TYPE DISK;
ALLOCATE AUXILIARY CHANNEL aux3 DEVICE TYPE DISK;
ALLOCATE AUXILIARY CHANNEL aux4 DEVICE TYPE DISK;
ALLOCATE CHANNEL ch1 DEVICE TYPE DISK;
ALLOCATE CHANNEL ch2 DEVICE TYPE DISK;
ALLOCATE CHANNEL ch3 DEVICE TYPE DISK;
ALLOCATE CHANNEL ch4 DEVICE TYPE DISK;
duplicate target database for standby from active database nofilenamecheck;
}
exit
__eof__


Release undo segments 
Based on  SR 3-23136948041 : UNDO Active segments are not being released. Together with end user we accepted solution provided by Oracle Support and I have already implemented it. 
In short solution is setting parameter _disable_flashback_archiver to value 2, which will enforce FBDA to run for clearing the Active Undo Segments. This is considered as solution not workaround. Details in mentioned SR.


kirstenkruuse@yahoo.com 
99683400 - sks 15-2434/2019 - Mette Inger Kruuse 

root/DBExaMaster12dm
grid/GridExa12dm
oracle/PexA2last4ever
ogg/Golden1937Gate

select * from v$standby_event_histogram where name like '%lag' and count >0;

find 2>/dev/null -maxdepth 1 -type d | while read -r dir; do printf "%s:\t" "$dir"; find "$dir" | wc -l; done


cd /u01/app/oracle/product/12.1.0/
chmod 775 client_1
cd client_1
chmod 775 client_1/bin client_1/lib client_1/network client_1/network/admin client_1/network/admin/tnsnames.ora client_1/network/admin/sqlnet.ora
chmod 775 bin/sqlplus bin/genezi bin/mkstore
chmod 775 client_1/lib/libsqlplus.so client_1/lib/libsqlplus.so client_1/lib/libclntsh.so.12.1  client_1/lib/libclntshcore.so.12.1 client_1/lib/libmql1.so client_1/lib/libipc1.so client_1/lib/libnnz12.so client_1/lib/libons.so
find client_1/nls/ -type f -exec chmod 775 {} \;
find client_1/nls/ -type d -exec chmod 775 {} \;
find client_1/ -name "*.msb" |xargs dirname|sort -u|xargs chmod 775
find client_1/ -name "*.msb" |xargs dirname|sort -u|xargs dirname|sort -u|xargs chmod 775
chmod 775 oracore/zoneinfo/ 
oracore/zoneinfo/timezone_18.dat oracore/zoneinfo/timezlrg_18.dat
find client_1/oracore/zoneinfo/ -name "time*.dat" -chmod 775 {} \; 


select  a.file_name,a.tablespace_name,a.autoextensible,b.db_unique_name,b.db_name,b.instance_name,b.open_mode,b.database_role,b.PDB_NAME,b.INSTANCE_HOST_NAME
from nodbot.datafiles a, nodbot.databases b
where a.db_id=b.db_id
and a.autoextensible='NO'
and b.pdb_name!='n/a'
and b.INSTANCE_HOST_NAME like 'db_s0%'

alter session set container=PNODBOTP;
set serveroutput on size 999999 lines 9999 pages 0 heading off trims on long 999999 
spool t.sql
declare 
 cursor c1 is 
   select  substr(b.instance_host_name,1,7) clust,substr(b.PDB_NAME,3,instr(b.PDB_NAME,'_',4)-3)||substr(b.PDB_NAME,length(b.PDB_NAME)) service,a.tablespace_name,
   decode(substr(b.PDB_NAME,length(b.PDB_NAME)),'P','p-scan.oneadr.net','d-scan.qaoneadr.local') postfix,substr(b.PDB_NAME,length(b.PDB_NAME)) env 
     from nodbot.datafiles a, nodbot.databases b
    where a.db_id=b.db_id
      and a.autoextensible='NO'
      and b.pdb_name!='n/a'
      and b.open_mode='READ WRITE'
      and b.active='Yes'
      and b.INSTANCE_HOST_NAME like 'db_s0%' 
	  and substr(b.db_name,length(b.db_name)) not in ('D','P')
--	  and rownum<11
	order by substr(b.instance_host_name,1,7),substr(b.PDB_NAME,3,instr(b.PDB_NAME,'_',4)-3)||substr(b.PDB_NAME,length(b.PDB_NAME)); 
  l_clust varchar2(256):='##'; 	  
  l_service varchar2(256):='##';
  l_passwd varchar2(256);  
begin 
  for r1 in c1 loop
    if l_clust<>r1.clust or l_service<>r1.service then 
	  if l_service<>'##' then 
        dbms_output.put_line('disc'); 
	  end if;
	  if r1.env='P' then 
	    l_passwd:='Pack2last4ever'; 
	  elsif r1.env='D' then 
	    l_passwd:='Deep2last4ever'; 
	  elsif r1.env='T' then 
	    l_passwd:='Town2last4ever'; 
	  elsif r1.env='S' then 
	    l_passwd:='Town2last4ever'; 
	  end if;
      dbms_output.put_line('conn system/'||l_passwd
	    ||'@(DESCRIPTION=(LOAD_BALANCE=on)(FAILOVER=Off)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST='||r1.clust||'hh'||r1.postfix
	    ||')(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST='||r1.clust||'oe'||r1.postfix||')(PORT=1521)))(CONNECT_DATA=(service_name='||r1.service||')))');
    end if; 
	dbms_output.put_line('alter tablespace '||r1.tablespace_name||' autoextend on next 16384m maxsize 4194304m;');
	l_clust:=r1.clust;
	l_service:=r1.service;
  end loop; 
  dbms_output.put_line('disc'); 
end;
/ 

application kode fra remedy asset replicate to looked up the nior database 

Lookup application code in 
Enterprise landscape 
https://el-portal.oneadr.net/EA-Portal2/MView?nav=SPBIT#

https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=1555077587350787&parent=DOCUMENT&sourceId=888828.1&id=1270094.1&_afrWindowMode=0&_adf.ctrl-state=s9sba7qtb_70
https://mosemp.us.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=1555077587350787&parent=DOCUMENT&sourceId=888828.1&id=1270094.1&_afrWindowMode=0&_adf.ctrl-state=s9sba7qtb_70

dlplOracleDBAConsultants@nordea.com
dlplOracleDevOps@nordea.com

INC000001244690 - GSID (ora-gsid-a.qaoneadr.local) database is very slow

rocedure send_email ( recipient_i   in varchar2,
                         subject_i     in varchar2,
                         message_i     in CLOB,
                         header_i      in varchar2 := null,
                         footer_i      in varchar2 := null,
                         recipients_i  in varchar2 := null,
                         cc_i          in varchar2 := null,
                         sender_i      in varchar2 := 'mcc_notification@'||g_dbname ) is
    l_conn utl_smtp.connection;
  begin
    l_conn := xs_sm_utils.begin_mail( pSender => sender_i,
                                      pRecipients => recipient_i,
                                      pCcRecipients => cc_i,
                                      pSubject => subject_i,
                                      pMimeType => 'text/html; charset=utf-8' );
    --
    xs_sm_utils.write_mb_text ( l_conn, '<h2>'||subject_i||'</h2>'||nl );
    xs_sm_utils.write_mb_text ( l_conn, recipients_i||nl );
    xs_sm_utils.write_mb_text ( l_conn, '<pre>' );
    if header_i is not null then
      xs_sm_utils.write_mb_text ( l_conn, header_i );
    end if;
    declare
      buffsize     constant integer := 8192;
      buff         varchar2 ( 8192 char );
      ofs          integer := 1;
    begin
      loop
        buff := substr ( message_i, ofs, buffsize );
        xs_sm_utils.write_mb_text ( l_conn, buff );
        exit when length(buff) < buffsize;
        ofs := ofs + buffsize;
      end loop;
    end;
    if footer_i is not null then
      xs_sm_utils.write_mb_text ( l_conn, footer_i );
    end if;
    xs_sm_utils.write_mb_text ( l_conn, '</pre>' );

 

    xs_sm_utils.end_mail ( l_conn );
  end send_email;
    

ndclonectl clone oraclehome --sourceOracleHome /u01/app/oracle/product/12.2.0.1/db201020b --destinationOracleHome /u01/app/oracle/product/12.2.0.1/db201020c
ndclonectl remove oraclehome --oracleHome /u01/app/oracle/product/12.2.0.1/db201020c

ndclonectl create clonefile --oracleHome /u01/app/oracle/product/12.2.0.1/db201020c --directory /patchtmp/

rman <<__eof__ 
connect target /
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '${ORACLE_HOME}/dbs/snapcf_${ORACLE_SID}.f';
__eof__

christian4tal
christian4Tal

agent12c
emctl stop agent
-- remove all on old server in oem 
export ORACLE_HOME=/u01/app/oracle/product/agent12cp/core/12.1.0.5.0
$ORACLE_HOME/perl/bin/perl $ORACLE_HOME/sysman/install/AgentDeinstall.pl -agentHome "$ORACLE_HOME" 
rm -rf /u01/app/oracle/product/agent12cp
rm -r /me01/oracle/agent12c
rm ~oracle/ora_setup/oraInst.loc_agent12cp
/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/temp_agent/instClient_12.1.0.5.0.sh

hcl tata cap gemini



mv /me01/oracle/dbadmin/backup/db_backup.sh /me01/oracle/dbadmin/backup/db_backup_3_1_44.sh
cp /net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/backup/history/db_backup_3_1_46.sh /me01/oracle/dbadmin/backup 
ln -s  /me01/oracle/dbadmin/backup/db_backup_3_1_46.sh /me01/oracle/dbadmin/backup/db_backup.sh 
/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/generic/backup/prep_disk


Claus Gorde. 
Story 


declare
procedure do(p_sql in varchar2) as 
begin
  execute immediate p_sql; 
  --dbms_output.put_line(p_sql); 
exception when others then 
  dbms_output.put_line(sqlerrm||' <'||p_sql||'>'); 
end; 
begin
for r0 in (select owner,index_name from dba_indexes i where tablespace_name='MARSP_I' and partitioned='NO'
and not exists(select 1 from dba_constraints c where i.owner=c.owner and i.index_name=c.constraint_name and c.constraint_type='P')) loop
do('drop index '||r0.owner||'.'||r0.index_name); 
end loop; 
end; 
/ 

select replace(dbms_metadata.get_ddl('INDEX',i.index_name,i.owner),'MARSP_I','MARSP2_I')||';' 
from dba_indexes i,dba_constraints c 
where i.owner=c.owner and i.index_name=c.constraint_name and c.constraint_type='P'
and i.tablespace_name='MARSP_I' and i.partitioned='NO';


alter tablespace marsp2_i add datafile '/u011/oradata/infoat/group2/datafile/marsp2_i_006.dbf' size 16385m
,'/u020/oradata/infoat/group1/datafile/marsp2_i_007.dbf' size 16385m
,'/u046/oradata/infoat/group1/datafile/marsp2_i_008.dbf' size 16385m
,'/u031/oradata/infoat/group0/datafile/marsp2_i_009.dbf' size 16385m
; 


declare
procedure do(p_sql in varchar2) as 
begin
  execute immediate p_sql; 
  -- dbms_output.put_line(p_sql); 
exception when others then 
  dbms_output.put_line(sqlerrm||' <'||p_sql||'>'); 
end; 
begin
for r0 in (select i.owner,i.index_name,c.table_name,replace(dbms_metadata.get_ddl('CONSTRAINT',i.index_name,i.owner),'MARSP_I','MARSP2_I') msql 
             from dba_indexes i,
			      dba_constraints c
			 where tablespace_name='MARSP_I' 
			   and partitioned='NO'
			   and i.owner=c.owner 
			   and i.index_name=c.constraint_name 
			   and c.constraint_type='P'
			   and rownum<21) loop
do('alter table '||r0.owner||'.'||r0.table_name||' drop constraint '||r0.index_name);
do('drop index '||r0.owner||'.'||r0.index_name);
do(r0.msql); 
end loop; 
end; 
/ 

 CREATE UNIQUE INDEX "MARSP"."HS_EQUITY_QUOTIENT_PK" ON "MARSP"."HS_EQUITY_QUOTIENT" ("TIMEINTERVAL_GRP_ID", "EFFECT_ID",
"TIMEINTERVAL_ID")
  PCTFREE 5 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS NOLOGGING
  STORAGE(INITIAL 8388608 NEXT 8388608 MINEXTENTS 1
MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
TABLESPACE "MARSP2_I" compute statistics;

 marsp.equity_sens_corr w, marsp.trans_equity_sens a, marsp.trans_status b, marsp.trans c
 
 Oracle PRE-Prod databases down

connect target sys/Pony2last4ever@tcdb1p
connect auxiliary sys/Pony2last4ever@tcdb3p
run {
allocate channel d1 type disk ;
allocate channel d2 type disk ;
backup as copy datafile '/u005/oradata/tcdbp/group1/datafile/td_imp_ts_data_303.dbf' 
               auxiliary format '/u05/oradata/tcdbp/datafile/td_imp_ts_data_303.dbf';
} 

 set newname for datafile 663 to '/u05/oradata/tcdbp/datafile/td_imp_ts_data_303.dbf'; 
 switch clone datafile 663;
}

mkdir -p /me01/oracle/oraInventory
touch /me01/oracle/oraInventory/orainstRoot.sh
chmod 700 /me01/oracle/oraInventory/orainstRoot.sh
vi /me01/oracle/oraInventory/orainstRoot.sh


rm /me01/oracle/oraInventory/orainstRoot.sh
rmdir /me01/oracle/oraInventory


Nordea > Delivery > Operations Center - Monitoring operations

ssc_nordea_db_grp@oracle.com 

CRQ001000067694,CRQ001000067760,CRQ001000069238,CRQ001000070012 

select 'set newname for datafile '||file#||' to ''/u'||trim(to_char(mod(file#-1,6)+1,'009'))||'/oradata/wstcd/group'||mod(trunc((file#-1)/3),2)||'/'||substr(name,instr(name,'/',-1)+1)||''';'
from v$datafile
order by file#
/
select 'set newname for tempfile '||file#||' to ''/u'||trim(to_char(mod(file#-1,6)+1,'009'))||'/oradata/wstcd/group'||mod(trunc((file#-1)/3),2)||'/'||substr(name,instr(name,'/',-1)+1)||''';'
from v$tempfile
order by file#
/

/net/is-nfsorad/cfs/is-nfsorad/ora_export/scripts/Linux_64/CloneTree/12.2.0.1/CloneClient_cl190115a.tar


csi 21004677



